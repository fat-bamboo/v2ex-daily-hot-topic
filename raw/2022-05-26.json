[{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/44f6/83a8/62_large.png?m=1644475743","name":"php","avatar_normal":"https://cdn.v2ex.com/navatar/44f6/83a8/62_normal.png?m=1644475743","title":"PHP","url":"https://www.v2ex.com/go/php","topics":4468,"footer":"","header":"PHP 是一门被广泛使用的编程语言，尤其是在各类互联网站项目中。PHP 代码可以被很容易地嵌入到 HTML 中。","title_alternative":"PHP","avatar_mini":"https://cdn.v2ex.com/navatar/44f6/83a8/62_mini.png?m=1644475743","stars":2666,"aliases":[],"root":false,"id":62,"parent_node_name":"programming"},"member":{"id":19577,"username":"minuo0day","url":"https://www.v2ex.com/u/minuo0day","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/b323/c8ed/19577_mini.png?m=1336147388","avatar_normal":"https://cdn.v2ex.com/avatar/b323/c8ed/19577_normal.png?m=1336147388","avatar_large":"https://cdn.v2ex.com/avatar/b323/c8ed/19577_large.png?m=1336147388","created":1334715526,"last_modified":1336147388},"last_reply_by":"LeeReamond","last_touched":1653540519,"title":"关于 PHP 高并发，请教各位","url":"https://www.v2ex.com/t/855361","created":1653530016,"deleted":0,"content":"H5 页面的核酸系统，前后端分离，前端 VUE ，后端 PHP 自己搭的 larave 框架，数据库 mysql,Nginx ，\r\n三台负载均衡的天翼云应用服务器，都是 32 核 64G ，一台数据库服务器 16 核 32G ；\r\n基本业务逻辑：\r\n用户端，进入页面绑定自己身份证号手机号乡镇信息等个人信息，前端凭借身份证号直接生成个人二维码，向医护人员出示二维码，1 个小时需要做 40 万人口的核酸；\r\n医护端，手机号身份证号登录或者申请，登入先选采集点，扫开箱码，再扫试管码选择十合一或二十合一，再点击添加人员打开扫一扫扫居民个人码添加；\r\n\r\n24 日早上 4 点 30 ，医护人员开始大量的开始进入程序扫箱码开箱，并在后台开始大量的添加临时采集点，于 4 点 58 分，CPU 使用率 100%，系统崩溃，日志显示，瞬间请求数 1 万 4 ，重启在进入还是崩；\r\n\r\n24 日下午系统整体挪到阿里云服务器，也是三台负载均衡的服务器，三台 32 核 64G ，加了 OSS ，用了阿里云的云数据库 RDS 版，主实例 8 核 16G ，只读数据库服务器 8 核，压测 10 分钟 15 万人，和 4000 医护人员同时在线也崩了，数据库和应用服务器的 CPU 利用率都打到了 100%，为了保障第二天不出问题，临时调大了一台应用服务器调到了 52 核，并同时把读写的两台数据库服务器都调到了最大 104 核，第二天检测才扛过去。\r\n\r\n问：我们虽然调大了服务器的配置，但调大以后压测 10 分钟 20 万人和 4000 医护在线，服务器承载 20%都上不去，但前端页面会变得非常慢，基本上 10 几秒才能打开，这种情况请大神指点","content_rendered":"<p>H5 页面的核酸系统，前后端分离，前端 VUE ，后端 PHP 自己搭的 larave 框架，数据库 mysql,Nginx ，\n三台负载均衡的天翼云应用服务器，都是 32 核 64G ，一台数据库服务器 16 核 32G ；\n基本业务逻辑：\n用户端，进入页面绑定自己身份证号手机号乡镇信息等个人信息，前端凭借身份证号直接生成个人二维码，向医护人员出示二维码，1 个小时需要做 40 万人口的核酸；\n医护端，手机号身份证号登录或者申请，登入先选采集点，扫开箱码，再扫试管码选择十合一或二十合一，再点击添加人员打开扫一扫扫居民个人码添加；</p>\n<p>24 日早上 4 点 30 ，医护人员开始大量的开始进入程序扫箱码开箱，并在后台开始大量的添加临时采集点，于 4 点 58 分，CPU 使用率 100%，系统崩溃，日志显示，瞬间请求数 1 万 4 ，重启在进入还是崩；</p>\n<p>24 日下午系统整体挪到阿里云服务器，也是三台负载均衡的服务器，三台 32 核 64G ，加了 OSS ，用了阿里云的云数据库 RDS 版，主实例 8 核 16G ，只读数据库服务器 8 核，压测 10 分钟 15 万人，和 4000 医护人员同时在线也崩了，数据库和应用服务器的 CPU 利用率都打到了 100%，为了保障第二天不出问题，临时调大了一台应用服务器调到了 52 核，并同时把读写的两台数据库服务器都调到了最大 104 核，第二天检测才扛过去。</p>\n<p>问：我们虽然调大了服务器的配置，但调大以后压测 10 分钟 20 万人和 4000 医护在线，服务器承载 20%都上不去，但前端页面会变得非常慢，基本上 10 几秒才能打开，这种情况请大神指点</p>\n","last_modified":1653530016,"replies":89,"id":855361},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1651385949","name":"programmer","avatar_normal":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1651385949","title":"程序员","url":"https://www.v2ex.com/go/programmer","topics":48950,"footer":"","header":"While code monkeys are not eating bananas, they're coding.","title_alternative":"Programmer","avatar_mini":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1651385949","stars":7836,"aliases":[],"root":false,"id":300,"parent_node_name":"computer"},"member":{"id":418864,"username":"Jiajin","url":"https://www.v2ex.com/u/Jiajin","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/1e1ab2b2dc326b845b2bee1ce95a43e8?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/1e1ab2b2dc326b845b2bee1ce95a43e8?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/1e1ab2b2dc326b845b2bee1ce95a43e8?s=73&d=retro","created":1559699511,"last_modified":1647328575},"last_reply_by":"yfugibr","last_touched":1653536139,"title":"github copilot 你们会用在公司项目上开发吗？","url":"https://www.v2ex.com/t/855352","created":1653527825,"deleted":0,"content":"很早之前就申请试用了。但是只在个人项目里用过，没在生产项目里用过。 \r\n\r\n有两个原因：  \r\n\r\n1 、最主要的原因：会把公司代码上传到 copilot 服务器，虽然咱这代码没什么宝贵的，但是还是有点违反保密的问题  \r\n2 、次要原因：确实智能，但是会和 IDEA 的智能补全略微有点冲突，而且有时候不是我想要写的代码，就有点打乱思路\r\n\r\n\r\n各位，你们怎么看？","content_rendered":"<p>很早之前就申请试用了。但是只在个人项目里用过，没在生产项目里用过。 </p>\n<p>有两个原因：  </p>\n<p>1 、最主要的原因：会把公司代码上传到 copilot 服务器，虽然咱这代码没什么宝贵的，但是还是有点违反保密的问题<br/>\n2 、次要原因：确实智能，但是会和 IDEA 的智能补全略微有点冲突，而且有时候不是我想要写的代码，就有点打乱思路</p>\n<p>各位，你们怎么看？</p>\n","last_modified":1653527825,"replies":31,"id":855352},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6e27/13a6/557_large.png?m=1608969785","name":"life","avatar_normal":"https://cdn.v2ex.com/navatar/6e27/13a6/557_normal.png?m=1608969785","title":"生活","url":"https://www.v2ex.com/go/life","topics":3171,"footer":"","header":"生活中的技术讨论","title_alternative":"Life","avatar_mini":"https://cdn.v2ex.com/navatar/6e27/13a6/557_mini.png?m=1608969785","stars":838,"aliases":[],"root":false,"id":557,"parent_node_name":""},"member":{"id":382565,"username":"ccppgo","url":"https://www.v2ex.com/u/ccppgo","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/0d142d8b3b37eaedea936390a9f5b2f7?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/0d142d8b3b37eaedea936390a9f5b2f7?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/0d142d8b3b37eaedea936390a9f5b2f7?s=73&d=retro","created":1549688592,"last_modified":1649650652},"last_reply_by":"diegozhu","last_touched":1653534415,"title":"把一辆老迈腾刮蹭了，留了电话，老哥们帮我看看大概需要赔多少","url":"https://www.v2ex.com/t/855353","created":1653527896,"deleted":0,"content":"黑色车是被刮的，银车是我车， 红色框框住的确定是我刮的，蓝色圈不确定， 打算如果 300 以下就自己掏了，如果更多就直接走保险\r\n\r\n![XAqLU1.md.png]( https://s1.ax1x.com/2022/05/26/XAqLU1.md.png)\r\n\r\n![XAqO4x.md.png]( https://s1.ax1x.com/2022/05/26/XAqO4x.md.png)","content_rendered":"<p>黑色车是被刮的，银车是我车， 红色框框住的确定是我刮的，蓝色圈不确定， 打算如果 300 以下就自己掏了，如果更多就直接走保险</p>\n<p><img alt=\"XAqLU1.md.png\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://s1.ax1x.com/2022/05/26/XAqLU1.md.png\"/></p>\n<p><img alt=\"XAqO4x.md.png\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://s1.ax1x.com/2022/05/26/XAqO4x.md.png\"/></p>\n","last_modified":1653528102,"replies":26,"id":855353},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c74d/97b0/16_large.png?m=1650127281","name":"share","avatar_normal":"https://cdn.v2ex.com/navatar/c74d/97b0/16_normal.png?m=1650127281","title":"分享发现","url":"https://www.v2ex.com/go/share","topics":35527,"footer":"","header":"分享你看到的好玩的，有信息量的，欢迎从这里获取灵感。","title_alternative":"Share","avatar_mini":"https://cdn.v2ex.com/navatar/c74d/97b0/16_mini.png?m=1650127281","stars":4840,"aliases":[],"root":false,"id":16,"parent_node_name":"v2ex"},"member":{"id":138873,"username":"zhoushiya","url":"https://www.v2ex.com/u/zhoushiya","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/264e/f414/138873_mini.png?m=1652601975","avatar_normal":"https://cdn.v2ex.com/avatar/264e/f414/138873_normal.png?m=1652601975","avatar_large":"https://cdn.v2ex.com/avatar/264e/f414/138873_large.png?m=1652601975","created":1442558065,"last_modified":1652601975},"last_reply_by":"Norths","last_touched":1653540605,"title":"非常不错的 go 微社区“泡泡”要开源了","url":"https://www.v2ex.com/t/855385","created":1653533771,"deleted":0,"content":"这是微社区的地址 https://www.paopao.info/ \r\n\r\n作者 @rocboss 终于答应要开源了，喜欢的赶紧来帮忙 star ，只要 500 个 star 就发布源码了\r\n\r\nhttps://github.com/rocboss/paopao-ce","content_rendered":"这是微社区的地址 <a target=\"_blank\" href=\"https://www.paopao.info/\" rel=\"nofollow noopener\">https://www.paopao.info/</a> <br /><br />作者 @<a target=\"_blank\" href=\"/member/rocboss\" rel=\"nofollow noopener\">rocboss</a> 终于答应要开源了，喜欢的赶紧来帮忙 star ，只要 500 个 star 就发布源码了<br /><br /><a target=\"_blank\" href=\"https://github.com/rocboss/paopao-ce\" rel=\"nofollow noopener\">https://github.com/rocboss/paopao-ce</a>","last_modified":1653533771,"replies":23,"id":855385},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/a5e0/0132/146_large.png?m=1650095218","name":"js","avatar_normal":"https://cdn.v2ex.com/navatar/a5e0/0132/146_normal.png?m=1650095218","title":"JavaScript","url":"https://www.v2ex.com/go/js","topics":2788,"footer":"","header":"JavaScript (sometimes abbreviated JS) is a prototype-based scripting language that is dynamic, weakly typed and has first-class functions.","title_alternative":"JavaScript","avatar_mini":"https://cdn.v2ex.com/navatar/a5e0/0132/146_mini.png?m=1650095218","stars":2800,"aliases":[],"root":false,"id":146,"parent_node_name":"programming"},"member":{"id":413366,"username":"fenglala","url":"https://www.v2ex.com/u/fenglala","website":"http://code4lala.vip","twitter":"","psn":"","github":"code4lala","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/4342/5bdd/413366_mini.png?m=1646553557","avatar_normal":"https://cdn.v2ex.com/avatar/4342/5bdd/413366_normal.png?m=1646553557","avatar_large":"https://cdn.v2ex.com/avatar/4342/5bdd/413366_large.png?m=1646553557","created":1558152021,"last_modified":1646553557},"last_reply_by":"libook","last_touched":1653535308,"title":"新人 JavaScript 求助语法问题","url":"https://www.v2ex.com/t/855376","created":1653532187,"deleted":0,"content":"``` js\r\nfunction sleepPromise() {\r\n    return new Promise((resolve, reject) => {\r\n        setTimeout(() => {\r\n            console.log(\"promise\")\r\n        }, 1000)\r\n    })\r\n}\r\n\r\nsleepPromise() // 这里没有分号\r\n\r\n    (function () {\r\n        console.log(\"hhh\")\r\n    })()\r\n```\r\n\r\n为啥调用 sleepPromise()的时候不加分号，就会跑不起来，加了分号就可以了\r\n\r\n```\r\nPS C:\\Users\\lala\\Downloads> node c.js\r\nC:\\Users\\lala\\Downloads\\c.js:11\r\n    (function () {\r\n    ^\r\n\r\nTypeError: sleepPromise(...) is not a function\r\n    at Object.<anonymous> (C:\\Users\\lala\\Downloads\\c.js:11:5)\r\n    at Module._compile (node:internal/modules/cjs/loader:1105:14)\r\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1159:10)\r\n    at Module.load (node:internal/modules/cjs/loader:981:32)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12)\r\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)\r\n    at node:internal/main/run_main_module:17:47\r\n```\r\n\r\n加了分号之后\r\n\r\n``` js\r\nfunction sleepPromise() {\r\n    return new Promise((resolve, reject) => {\r\n        setTimeout(() => {\r\n            console.log(\"promise\")\r\n        }, 1000)\r\n    })\r\n}\r\n\r\nsleepPromise(); // 这里有分号\r\n\r\n    (function () {\r\n        console.log(\"hhh\")\r\n    })()\r\n```\r\n\r\n```\r\nPS C:\\Users\\lala\\Downloads> node c.js\r\nhhh\r\npromise\r\n```\r\n\r\n我会 C ，但是不会 JavaScript ，求指教，感谢！","content_rendered":"<pre><code class=\"language-js\">function sleepPromise() {\n    return new Promise((resolve, reject) =&gt; {\n        setTimeout(() =&gt; {\n            console.log(\"promise\")\n        }, 1000)\n    })\n}\n\nsleepPromise() // 这里没有分号\n\n    (function () {\n        console.log(\"hhh\")\n    })()\n</code></pre>\n<p>为啥调用 sleepPromise()的时候不加分号，就会跑不起来，加了分号就可以了</p>\n<pre><code>PS C:\\Users\\lala\\Downloads&gt; node c.js\nC:\\Users\\lala\\Downloads\\c.js:11\n    (function () {\n    ^\n\nTypeError: sleepPromise(...) is not a function\n    at Object.&lt;anonymous&gt; (C:\\Users\\lala\\Downloads\\c.js:11:5)\n    at Module._compile (node:internal/modules/cjs/loader:1105:14)\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1159:10)\n    at Module.load (node:internal/modules/cjs/loader:981:32)\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)\n    at node:internal/main/run_main_module:17:47\n</code></pre>\n<p>加了分号之后</p>\n<pre><code class=\"language-js\">function sleepPromise() {\n    return new Promise((resolve, reject) =&gt; {\n        setTimeout(() =&gt; {\n            console.log(\"promise\")\n        }, 1000)\n    })\n}\n\nsleepPromise(); // 这里有分号\n\n    (function () {\n        console.log(\"hhh\")\n    })()\n</code></pre>\n<pre><code>PS C:\\Users\\lala\\Downloads&gt; node c.js\nhhh\npromise\n</code></pre>\n<p>我会 C ，但是不会 JavaScript ，求指教，感谢！</p>\n","last_modified":1653532205,"replies":20,"id":855376},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185185,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":215915,"username":"TabGre","url":"https://www.v2ex.com/u/TabGre","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/0d95d9cf2ead3717880da9e222864c71?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/0d95d9cf2ead3717880da9e222864c71?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/0d95d9cf2ead3717880da9e222864c71?s=73&d=retro","created":1487404269,"last_modified":1487404269},"last_reply_by":"Caribbeancom","last_touched":1653535332,"title":"内置 KVM 的显示器推荐","url":"https://www.v2ex.com/t/855355","created":1653528362,"deleted":0,"content":"需求上：\r\n\r\n内置 KVM ，支持同时输入多个信号（两台 macbook ）, 并能不同桌面显示不同的输入源，仅仅通过切换桌面就能切换输入源。\r\n\r\n预算：5000 以内\r\n品牌：大品牌吧","content_rendered":"<p>需求上：</p>\n<p>内置 KVM ，支持同时输入多个信号（两台 macbook ）, 并能不同桌面显示不同的输入源，仅仅通过切换桌面就能切换输入源。</p>\n<p>预算：5000 以内\n品牌：大品牌吧</p>\n","last_modified":1653528362,"replies":20,"id":855355},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185185,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":87440,"username":"Leronron","url":"https://www.v2ex.com/u/Leronron","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/1619/d4d9/87440_mini.png?m=1433236502","avatar_normal":"https://cdn.v2ex.com/avatar/1619/d4d9/87440_normal.png?m=1433236502","avatar_large":"https://cdn.v2ex.com/avatar/1619/d4d9/87440_large.png?m=1433236502","created":1418978725,"last_modified":1433236502},"last_reply_by":"xsm1890","last_touched":1653507475,"title":"昨天 10 万人大会稳经济没人关注吗","url":"https://www.v2ex.com/t/855383","created":1653533303,"deleted":0,"content":"这么大的阵容第一次见","content_rendered":"这么大的阵容第一次见","last_modified":1653533303,"replies":19,"id":855383},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6353/8fe6/519_large.png?m=1595507885","name":"ideas","avatar_normal":"https://cdn.v2ex.com/navatar/6353/8fe6/519_normal.png?m=1595507885","title":"奇思妙想","url":"https://www.v2ex.com/go/ideas","topics":4984,"footer":"","header":"让你的创意在这里自由流动吧。","title_alternative":"Ideas","avatar_mini":"https://cdn.v2ex.com/navatar/6353/8fe6/519_mini.png?m=1595507885","stars":2600,"aliases":[],"root":false,"id":519,"parent_node_name":"v2ex"},"member":{"id":573767,"username":"meetalpha","url":"https://www.v2ex.com/u/meetalpha","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/8edbdfd80b212dc67b0d38a5490f175a?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/8edbdfd80b212dc67b0d38a5490f175a?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/8edbdfd80b212dc67b0d38a5490f175a?s=73&d=retro","created":1645805411,"last_modified":1651142977},"last_reply_by":"mozhizhu","last_touched":1653535843,"title":"可以用手机号找回密码的服务，运营商是否能做到私自拿手机号请求并看到验证码？","url":"https://www.v2ex.com/t/855356","created":1653528798,"deleted":0,"content":"如题。","content_rendered":"如题。","last_modified":1653528798,"replies":15,"id":855356},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1652980294","name":"career","avatar_normal":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1652980294","title":"职场话题","url":"https://www.v2ex.com/go/career","topics":13108,"footer":"","header":"这里，我们聊聊那些工作中遇到的开心和不开心的事。","title_alternative":"Career","avatar_mini":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1652980294","stars":2370,"aliases":[],"root":false,"id":770,"parent_node_name":"work"},"member":{"id":484169,"username":"AndroidManger","url":"https://www.v2ex.com/u/AndroidManger","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/bf4f49c36e75e20ee128aabe294b9bbd?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/bf4f49c36e75e20ee128aabe294b9bbd?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/bf4f49c36e75e20ee128aabe294b9bbd?s=73&d=retro","created":1587024549,"last_modified":1587024549},"last_reply_by":"Suddoo","last_touched":1653535248,"title":"做程序员三年温水煮青蛙，如何改变","url":"https://www.v2ex.com/t/855354","created":1653528215,"deleted":0,"content":"大佬们，做程序员也有三年啦，一直在传统行业做 Android 开发，感觉都没有什么进步，现在都很茫然，都不知道怎么去学习改变自己啦","content_rendered":"<p>大佬们，做程序员也有三年啦，一直在传统行业做 Android 开发，感觉都没有什么进步，现在都很茫然，都不知道怎么去学习改变自己啦</p>\n","last_modified":1653528215,"replies":14,"id":855354},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1635654723","name":"bb","avatar_normal":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1635654723","title":"宽带症候群","url":"https://www.v2ex.com/go/bb","topics":10836,"footer":"","header":"网速很重要。比快更快。","title_alternative":"Broadband Symptom Complex","avatar_mini":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1635654723","stars":5603,"aliases":[],"root":false,"id":108,"parent_node_name":"geek"},"member":{"id":175021,"username":"Saitama","url":"https://www.v2ex.com/u/Saitama","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/714c6870176a3c65e6893e9b120ed2f5?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/714c6870176a3c65e6893e9b120ed2f5?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/714c6870176a3c65e6893e9b120ed2f5?s=73&d=retro","created":1464408460,"last_modified":1464408460},"last_reply_by":"lxr760","last_touched":1653539972,"title":"出租屋杭州移动 100M 宽带, Wifi 速度时不时掉到 0, 有什么排查问题的方法吗?","url":"https://www.v2ex.com/t/855378","created":1653532376,"deleted":0,"content":"出租屋自己买了一个华为的 AX2 pro 路由器. 我寻思 100M 的宽带应该不至于是性能不够把.\r\n刷 B 站的时候偶尔会出现卡主的现象.(大部分时间都是秒开, 但是常常会卡主 10 来秒), 有时候电视机看爱奇艺也会出现速度掉到 0 的现象.\r\n请问这是移动宽带的问题, 还是路由器的问题?怎么排查呢.","content_rendered":"<p>出租屋自己买了一个华为的 AX2 pro 路由器. 我寻思 100M 的宽带应该不至于是性能不够把.\n刷 B 站的时候偶尔会出现卡主的现象.(大部分时间都是秒开, 但是常常会卡主 10 来秒), 有时候电视机看爱奇艺也会出现速度掉到 0 的现象.\n请问这是移动宽带的问题, 还是路由器的问题?怎么排查呢.</p>\n","last_modified":1653532376,"replies":12,"id":855378},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185189,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":156673,"username":"xctcc","url":"https://www.v2ex.com/u/xctcc","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/4fb1/1f1a/156673_mini.png?m=1653531683","avatar_normal":"https://cdn.v2ex.com/avatar/4fb1/1f1a/156673_normal.png?m=1653531683","avatar_large":"https://cdn.v2ex.com/avatar/4fb1/1f1a/156673_large.png?m=1653531683","created":1453546773,"last_modified":1653531683},"last_reply_by":"devswork","last_touched":1653538792,"title":"笔记本的内存占用感觉有点奇怪","url":"https://www.v2ex.com/t/855373","created":1653531802,"deleted":0,"content":"内存是 16g 的，开机没几个程序就占了 50%,chrome 打开一个网页就升 9%，多打开几个就快 100%，有人知道这是什么问题吗\r\nhttps://i.imgur.com/8CvDSwT.png\r\nhttps://i.imgur.com/lKdpdor.png\r\nhttps://i.imgur.com/hvDDprc.png","content_rendered":"内存是 16g 的，开机没几个程序就占了 50%,chrome 打开一个网页就升 9%，多打开几个就快 100%，有人知道这是什么问题吗<br /><a target=\"_blank\" href=\"https://i.imgur.com/8CvDSwT.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/8CvDSwT.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><a target=\"_blank\" href=\"https://i.imgur.com/lKdpdor.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/lKdpdor.png\" class=\"embedded_image\" rel=\"noreferrer\"></a><br /><a target=\"_blank\" href=\"https://i.imgur.com/hvDDprc.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.imgur.com/hvDDprc.png\" class=\"embedded_image\" rel=\"noreferrer\"></a>","last_modified":1653531802,"replies":12,"id":855373},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1651385949","name":"programmer","avatar_normal":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1651385949","title":"程序员","url":"https://www.v2ex.com/go/programmer","topics":48949,"footer":"","header":"While code monkeys are not eating bananas, they're coding.","title_alternative":"Programmer","avatar_mini":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1651385949","stars":7836,"aliases":[],"root":false,"id":300,"parent_node_name":"computer"},"member":{"id":331892,"username":"xnyu125","url":"https://www.v2ex.com/u/xnyu125","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/avatar/b803/097a/331892_mini.png?m=1652886896","avatar_normal":"https://cdn.v2ex.com/avatar/b803/097a/331892_normal.png?m=1652886896","avatar_large":"https://cdn.v2ex.com/avatar/b803/097a/331892_large.png?m=1652886896","avatar_xlarge":"https://cdn.v2ex.com/avatar/b803/097a/331892_xlarge.png?m=1652886896","avatar_xxlarge":"https://cdn.v2ex.com/avatar/b803/097a/331892_xlarge.png?m=1652886896","avatar_xxxlarge":"https://cdn.v2ex.com/avatar/b803/097a/331892_xlarge.png?m=1652886896","created":1532325808,"last_modified":1652886896},"last_reply_by":"hugo2lee","last_touched":1653530667,"title":"一次集文化差异、网络工程与诸多巧合于一身的 debug！","url":"https://www.v2ex.com/t/855346","created":1653524104,"deleted":0,"content":"分享一个异常精彩的关于有线网络喜欢红茶的故事，先上为敬：[https://qualityfocus.club/fun-debug]( https://qualityfocus.club/fun-debug)\r\n\r\n做软件做久了，很容易碰到各种匪夷所思的 bug ，你写过 /改过 /测过 /听过哪些有趣的 bug 呢？欢迎留言讨论。","content_rendered":"<p>分享一个异常精彩的关于有线网络喜欢红茶的故事，先上为敬：<a href=\"https://qualityfocus.club/fun-debug\" rel=\"nofollow\">https://qualityfocus.club/fun-debug</a></p>\n<p>做软件做久了，很容易碰到各种匪夷所思的 bug ，你写过 /改过 /测过 /听过哪些有趣的 bug 呢？欢迎留言讨论。</p>\n","last_modified":1653524104,"replies":12,"id":855346},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185189,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":443673,"username":"MrLQX","url":"https://www.v2ex.com/u/MrLQX","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_mini.png?m=1645759542","avatar_normal":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_normal.png?m=1645759542","avatar_large":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_large.png?m=1645759542","avatar_xlarge":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_xlarge.png?m=1645759542","avatar_xxlarge":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_xlarge.png?m=1645759542","avatar_xxxlarge":"https://cdn.v2ex.com/avatar/2c83/a8f9/443673_xlarge.png?m=1645759542","created":1569573911,"last_modified":1645759542},"last_reply_by":"estk","last_touched":1653540166,"title":"买了一个腾讯云轻量级服务器，不知道拿来干啥用","url":"https://www.v2ex.com/t/855395","created":1653535000,"deleted":0,"content":"之前看到腾讯云有优惠，花了 222 买了一个三年的 2 核 4g 的腾讯云轻量级服务器，顺便买了一个域名，备案啥也都搞好了，然后就不知道拿来干啥了，一直吃灰","content_rendered":"<p>之前看到腾讯云有优惠，花了 222 买了一个三年的 2 核 4g 的腾讯云轻量级服务器，顺便买了一个域名，备案啥也都搞好了，然后就不知道拿来干啥了，一直吃灰</p>\n","last_modified":1653535000,"replies":11,"id":855395},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/069d/3bb0/580_large.png?m=1647952441","name":"ios","avatar_normal":"https://cdn.v2ex.com/navatar/069d/3bb0/580_normal.png?m=1647952441","title":"iOS","url":"https://www.v2ex.com/go/ios","topics":3051,"footer":"","header":"运行于 Apple 移动设备上的操作系统。","title_alternative":"iOS","avatar_mini":"https://cdn.v2ex.com/navatar/069d/3bb0/580_mini.png?m=1647952441","stars":789,"aliases":[],"root":false,"id":580,"parent_node_name":"apple"},"member":{"id":296397,"username":"wpo","url":"https://www.v2ex.com/u/wpo","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/6c2807c2b52634e0607f0c7c32bfc42c?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/6c2807c2b52634e0607f0c7c32bfc42c?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/6c2807c2b52634e0607f0c7c32bfc42c?s=73&d=retro","created":1520139635,"last_modified":1520139635},"last_reply_by":"ryh","last_touched":1653540171,"title":"一个 iOS 应用审核说图标空白的问题","url":"https://www.v2ex.com/t/855379","created":1653532437,"deleted":0,"content":"不知道为什么，一个全新上架的 app ，回复拒绝说提供的图标是 blank （空白），给了附上了一个 600*600 的一张全黑图片（迷惑行为）。\r\n\r\n第一次拒绝消息：\r\n\r\nYour app or its metadata does not appear to include final content. Specifically, the app icon displayed on the App Store is blank.\r\n\r\nNext Steps\r\n\r\nTo resolve this issue, please ensure all your app icons are finalized and similar enough to each other to avoid creating confusion. When users search for your app on their devices, they should be able to recognize it from the icon on the App Store.\r\n\r\nResources\r\n\r\nSince the large app icon will be displayed for your app on the App Store, we recommend you provide an attractive, original icon that meets the following requirements for both iPhone and iPad apps. App Store Connect Help includes information on adding an App Store icon. Review the iOS Human Interface Guidelines for additional details about app icon image sizes and resolutions.\r\n\r\nFor resources on creating eye-catching icons, you may want to review the App Store Product Page information available on the Apple Developer website.\r\n\r\n-------\r\n\r\n我录了像演示了下从他们 connect 的 web 上看到的是有图片的，也从 TestFlight 开始演示了下载了同一个二进制产物安装到桌面到打开的过程。\r\n\r\n苹果再一次回复：\r\n\r\nHello,\r\n\r\nThank you for your response.\r\n\r\nHowever, we continue to find that the previously communicated issue still  persist.\r\n\r\nSpecifically, the app icon displayed on the App Store is still blank.\r\n\r\nNext Steps\r\n\r\nTo resolve this issue, please ensure all your app icons are finalized and similar enough to each other to avoid creating confusion. When users search for your app on their devices, they should be able to recognize it from the icon on the App Store.\r\n\r\nResources\r\n\r\nSince the large app icon will be displayed for your app on the App Store, we recommend you provide an attractive, original icon that meets the following requirements for both iPhone and iPad apps. App Store Connect Help includes information on adding an App Store icon. Review the iOS Human Interface Guidelines for additional details about app icon image sizes and resolutions.\r\n\r\nFor resources on creating eye-catching icons, you may want to review the App Store Product Page information available on the Apple Developer website.\r\n\r\n\r\nBest regards,\r\n\r\nApp Store Review\r\n\r\n\r\n\r\n-------\r\n搞不懂要接下来要怎么操作了。","content_rendered":"<p>不知道为什么，一个全新上架的 app ，回复拒绝说提供的图标是 blank （空白），给了附上了一个 600*600 的一张全黑图片（迷惑行为）。</p>\n<p>第一次拒绝消息：</p>\n<p>Your app or its metadata does not appear to include final content. Specifically, the app icon displayed on the App Store is blank.</p>\n<p>Next Steps</p>\n<p>To resolve this issue, please ensure all your app icons are finalized and similar enough to each other to avoid creating confusion. When users search for your app on their devices, they should be able to recognize it from the icon on the App Store.</p>\n<p>Resources</p>\n<p>Since the large app icon will be displayed for your app on the App Store, we recommend you provide an attractive, original icon that meets the following requirements for both iPhone and iPad apps. App Store Connect Help includes information on adding an App Store icon. Review the iOS Human Interface Guidelines for additional details about app icon image sizes and resolutions.</p>\n<p>For resources on creating eye-catching icons, you may want to review the App Store Product Page information available on the Apple Developer website.</p>\n<hr/>\n<p>我录了像演示了下从他们 connect 的 web 上看到的是有图片的，也从 TestFlight 开始演示了下载了同一个二进制产物安装到桌面到打开的过程。</p>\n<p>苹果再一次回复：</p>\n<p>Hello,</p>\n<p>Thank you for your response.</p>\n<p>However, we continue to find that the previously communicated issue still  persist.</p>\n<p>Specifically, the app icon displayed on the App Store is still blank.</p>\n<p>Next Steps</p>\n<p>To resolve this issue, please ensure all your app icons are finalized and similar enough to each other to avoid creating confusion. When users search for your app on their devices, they should be able to recognize it from the icon on the App Store.</p>\n<p>Resources</p>\n<p>Since the large app icon will be displayed for your app on the App Store, we recommend you provide an attractive, original icon that meets the following requirements for both iPhone and iPad apps. App Store Connect Help includes information on adding an App Store icon. Review the iOS Human Interface Guidelines for additional details about app icon image sizes and resolutions.</p>\n<p>For resources on creating eye-catching icons, you may want to review the App Store Product Page information available on the Apple Developer website.</p>\n<p>Best regards,</p>\n<p>App Store Review</p>\n<hr/>\n<p>搞不懂要接下来要怎么操作了。</p>\n","last_modified":1653532437,"replies":10,"id":855379},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/03af/dbd6/63_large.png?m=1644490200","name":"java","avatar_normal":"https://cdn.v2ex.com/navatar/03af/dbd6/63_normal.png?m=1644490200","title":"Java","url":"https://www.v2ex.com/go/java","topics":4949,"footer":"","header":"Sun 公司发明，被广泛使用的一门编程语言。","title_alternative":"Java","avatar_mini":"https://cdn.v2ex.com/navatar/03af/dbd6/63_mini.png?m=1644490200","stars":4911,"aliases":[],"root":false,"id":63,"parent_node_name":"programming"},"member":{"id":257481,"username":"linuxsteam","url":"https://www.v2ex.com/u/linuxsteam","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/7da0/eda5/257481_mini.png?m=1639019209","avatar_normal":"https://cdn.v2ex.com/avatar/7da0/eda5/257481_normal.png?m=1639019209","avatar_large":"https://cdn.v2ex.com/avatar/7da0/eda5/257481_large.png?m=1639019209","created":1506854575,"last_modified":1639019209},"last_reply_by":"AoEiuV020CN","last_touched":1653540515,"title":"Java 中通过 Runtime.exec 创建子进程时，父子进程管道通信问题","url":"https://www.v2ex.com/t/855368","created":1653530998,"deleted":0,"content":"小弟最近在研究父子进程中如何用管道进行通信，但是遇到一个情况，目前无法理解现有的答案。\r\n\r\n### 代码复现\r\nshell 脚本\r\n```shell\r\n#!/bin/bash\r\n\r\nfor((i=0; i<10913; i++));do\r\n    # 输出到 stdin\r\n    echo \"input\"\r\n    # 输出到 stderr\r\n    echo \"error\" 1>&2\r\ndone\r\n```\r\njava\r\n```java\r\npublic static Object executeCommand(String command) throws Exception\r\n    {\r\n        ProcessBuilder processBuilder = new ProcessBuilder(command);\r\n        Process process = processBuilder.start();\r\n        readStreamInfo(process.getInputStream(), process.getErrorStream());\r\n        int exit = process.waitFor();\r\n        process.destroy();\r\n        if (exit == 0)\r\n        {\r\n            System.out.println(\"子进程正常完成\");\r\n        }\r\n        else\r\n        {\r\n            System.out.println(\"子进程异常结束\");\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private static void readStreamInfo(InputStream... inputStreams){\r\n        try (BufferedReader br = new BufferedReader(new InputStreamReader(inputStreams[0]),8192))\r\n        {\r\n            String line;\r\n            int i = 0;\r\n            while (true)\r\n            {\r\n                String s = br.readLine();\r\n                if (s != null)\r\n                {\r\n                    System.out.println(++i + \" \" + s);\r\n                }\r\n                else\r\n                {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        catch (IOException e)\r\n        {\r\n            throw new RuntimeException(e);\r\n        }\r\n        finally\r\n        {\r\n            try\r\n            {\r\n                inputStreams[0].close();\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n\r\n\r\n        try (BufferedReader bufferedInput = new BufferedReader(new InputStreamReader(inputStreams[1])))\r\n        {\r\n            String line;\r\n            int i = 0;\r\n            while ((line = bufferedInput.readLine()) != null)\r\n            {\r\n                System.out.println(++i + \" \" + line);\r\n            }\r\n        }\r\n        catch (IOException e)\r\n        {\r\n            throw new RuntimeException(e);\r\n        }\r\n        finally\r\n        {\r\n            try\r\n            {\r\n                inputStreams[1].close();\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n```\r\n\r\n实测断点会卡在 String s = br.readLine();迟迟没有收到返回值。\r\n> shell 中 for 循环减少一次错误流输出上述代码就不会阻塞。\r\n\r\n\r\n#### 所以我参考网上搜索结果和查阅书籍下了个结论：\r\n> 以上问题是缓冲区满了导致的\r\n\r\n但是还是有几个问题不能理解，希望有研究过的大佬可以帮帮小弟。\r\n\r\n### 问题\r\n- 以上方式产生的父子进程标准 I/O 流的对应关系是下列我理解的哪一种？\r\n   1. 子进程的标准输出流，标准错误流重定向到父进程的标准输入流。（共用一个管道）\r\n   2. 子进程的标准输出流重定向到父进程的标准输入流，子进程的标准错误流重定向到父进程的标准错误流。（各自一个管道）\r\n- 我的代码为什么会阻塞？\r\n我就在 shell 中只写了一行标准输出，标准输入流已经读完了，为何会卡主。不应该直接返回 null 跳出循环吗？（在 InputStream.readLine()中看到了 EOF 相关字样，以为是没有读到 EOF 描述才卡死的。但是减少错误输出条数不会阻塞这个事实，让我放弃了这个理解）\r\n- 哪本书对于以上问题有所讲解。（我查了两本操作系统的书，感觉还是不能帮我理解以上问题）","content_rendered":"<p>小弟最近在研究父子进程中如何用管道进行通信，但是遇到一个情况，目前无法理解现有的答案。</p>\n<h3>代码复现</h3>\n<p>shell 脚本</p>\n<pre><code class=\"language-shell\">#!/bin/bash\n\nfor((i=0; i&lt;10913; i++));do\n    # 输出到 stdin\n    echo \"input\"\n    # 输出到 stderr\n    echo \"error\" 1&gt;&amp;2\ndone\n</code></pre>\n<p>java</p>\n<pre><code class=\"language-java\">public static Object executeCommand(String command) throws Exception\n    {\n        ProcessBuilder processBuilder = new ProcessBuilder(command);\n        Process process = processBuilder.start();\n        readStreamInfo(process.getInputStream(), process.getErrorStream());\n        int exit = process.waitFor();\n        process.destroy();\n        if (exit == 0)\n        {\n            System.out.println(\"子进程正常完成\");\n        }\n        else\n        {\n            System.out.println(\"子进程异常结束\");\n        }\n        return null;\n    }\n\n    private static void readStreamInfo(InputStream... inputStreams){\n        try (BufferedReader br = new BufferedReader(new InputStreamReader(inputStreams[0]),8192))\n        {\n            String line;\n            int i = 0;\n            while (true)\n            {\n                String s = br.readLine();\n                if (s != null)\n                {\n                    System.out.println(++i + \" \" + s);\n                }\n                else\n                {\n                    break;\n                }\n            }\n        }\n        catch (IOException e)\n        {\n            throw new RuntimeException(e);\n        }\n        finally\n        {\n            try\n            {\n                inputStreams[0].close();\n            }\n            catch (Exception e)\n            {\n                e.printStackTrace();\n            }\n        }\n\n\n        try (BufferedReader bufferedInput = new BufferedReader(new InputStreamReader(inputStreams[1])))\n        {\n            String line;\n            int i = 0;\n            while ((line = bufferedInput.readLine()) != null)\n            {\n                System.out.println(++i + \" \" + line);\n            }\n        }\n        catch (IOException e)\n        {\n            throw new RuntimeException(e);\n        }\n        finally\n        {\n            try\n            {\n                inputStreams[1].close();\n            }\n            catch (Exception e)\n            {\n                e.printStackTrace();\n            }\n        }\n    }\n</code></pre>\n<p>实测断点会卡在 String s = br.readLine();迟迟没有收到返回值。</p>\n<blockquote>\n<p>shell 中 for 循环减少一次错误流输出上述代码就不会阻塞。</p>\n</blockquote>\n<h4>所以我参考网上搜索结果和查阅书籍下了个结论：</h4>\n<blockquote>\n<p>以上问题是缓冲区满了导致的</p>\n</blockquote>\n<p>但是还是有几个问题不能理解，希望有研究过的大佬可以帮帮小弟。</p>\n<h3>问题</h3>\n<ul>\n<li>\n以上方式产生的父子进程标准 I/O 流的对应关系是下列我理解的哪一种？<ol>\n<li>子进程的标准输出流，标准错误流重定向到父进程的标准输入流。（共用一个管道）</li>\n<li>子进程的标准输出流重定向到父进程的标准输入流，子进程的标准错误流重定向到父进程的标准错误流。（各自一个管道）</li>\n</ol>\n</li>\n<li>我的代码为什么会阻塞？\n我就在 shell 中只写了一行标准输出，标准输入流已经读完了，为何会卡主。不应该直接返回 null 跳出循环吗？（在 InputStream.readLine()中看到了 EOF 相关字样，以为是没有读到 EOF 描述才卡死的。但是减少错误输出条数不会阻塞这个事实，让我放弃了这个理解）</li>\n<li>哪本书对于以上问题有所讲解。（我查了两本操作系统的书，感觉还是不能帮我理解以上问题）</li>\n</ul>\n","last_modified":1653531047,"replies":10,"id":855368},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1635654723","name":"bb","avatar_normal":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1635654723","title":"宽带症候群","url":"https://www.v2ex.com/go/bb","topics":10836,"footer":"","header":"网速很重要。比快更快。","title_alternative":"Broadband Symptom Complex","avatar_mini":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1635654723","stars":5603,"aliases":[],"root":false,"id":108,"parent_node_name":"geek"},"member":{"id":73070,"username":"l4ever","url":"https://www.v2ex.com/u/l4ever","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/4105/08ab/73070_mini.png?m=1542068231","avatar_normal":"https://cdn.v2ex.com/avatar/4105/08ab/73070_normal.png?m=1542068231","avatar_large":"https://cdn.v2ex.com/avatar/4105/08ab/73070_large.png?m=1542068231","created":1409928634,"last_modified":1542068231},"last_reply_by":"y051313","last_touched":1653535027,"title":"深圳电信访问 Paypal 怎么这么困难了.","url":"https://www.v2ex.com/t/855350","created":1653527159,"deleted":0,"content":"很难打开, 打开了也很难付款.\r\n梯子速度还挺好, 访问 google 系都很赞的情况下扶墙访问 Paypal 都觉得很慢.","content_rendered":"<p>很难打开, 打开了也很难付款.\n梯子速度还挺好, 访问 google 系都很赞的情况下扶墙访问 Paypal 都觉得很慢.</p>\n","last_modified":1653527159,"replies":10,"id":855350},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185189,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":92275,"username":"xzm1006","url":"https://www.v2ex.com/u/xzm1006","website":"","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/0a42/13b4/92275_mini.png?m=1425133920","avatar_normal":"https://cdn.v2ex.com/avatar/0a42/13b4/92275_normal.png?m=1425133920","avatar_large":"https://cdn.v2ex.com/avatar/0a42/13b4/92275_large.png?m=1425133920","created":1421475558,"last_modified":1425133920},"last_reply_by":"xzm1006","last_touched":1653538556,"title":"米家新风空调尊享版有人用过吗？","url":"https://www.v2ex.com/t/855409","created":1653538347,"deleted":0,"content":"RT ，网上逛了一圈，新风空调好像也没太多的选择\r\n\r\n不是新房装修，所以新风系统什么的不可能搞了\r\n\r\n主要是希望制冷制热的同时能改善空气质量，因为在南方，所以也希望除湿性能好点\r\n\r\n1.5 匹 60 米新风量对于 10 米室内空间应该会有很好效果吧？","content_rendered":"<p>RT ，网上逛了一圈，新风空调好像也没太多的选择</p>\n<p>不是新房装修，所以新风系统什么的不可能搞了</p>\n<p>主要是希望制冷制热的同时能改善空气质量，因为在南方，所以也希望除湿性能好点</p>\n<p>1.5 匹 60 米新风量对于 10 米室内空间应该会有很好效果吧？</p>\n","last_modified":1653538544,"replies":9,"id":855409},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185187,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":369205,"username":"rigan","url":"https://www.v2ex.com/u/rigan","website":"http://blog.xiaohack.org","twitter":"","psn":"","github":"","btc":"","location":"","tagline":"","bio":"色情","avatar_mini":"https://cdn.v2ex.com/avatar/779a/2b26/369205_mini.png?m=1652094384","avatar_normal":"https://cdn.v2ex.com/avatar/779a/2b26/369205_normal.png?m=1652094384","avatar_large":"https://cdn.v2ex.com/avatar/779a/2b26/369205_large.png?m=1652094384","created":1544383528,"last_modified":1652094384},"last_reply_by":"westoy","last_touched":1653538024,"title":"想买个镜头。佳能残画幅相机，想拍星空，之前看上图丽 11-20 F2.8 了，但是现在发现适马的 18-35 F1.8 的价格跟图丽的价格差不多，纠结到底买哪个","url":"https://www.v2ex.com/t/855360","created":1653529963,"deleted":0,"content":"价格图丽的 3700 ，适马的 4000.","content_rendered":"价格图丽的 3700 ，适马的 4000.","last_modified":1653529963,"replies":8,"id":855360},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1635654723","name":"bb","avatar_normal":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1635654723","title":"宽带症候群","url":"https://www.v2ex.com/go/bb","topics":10836,"footer":"","header":"网速很重要。比快更快。","title_alternative":"Broadband Symptom Complex","avatar_mini":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1635654723","stars":5603,"aliases":[],"root":false,"id":108,"parent_node_name":"geek"},"member":{"id":134395,"username":"lxr760","url":"https://www.v2ex.com/u/lxr760","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/24281d9c6caa29d3d3c47ffc2f2e86a8?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/24281d9c6caa29d3d3c47ffc2f2e86a8?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/24281d9c6caa29d3d3c47ffc2f2e86a8?s=73&d=retro","created":1440228118,"last_modified":1650685141},"last_reply_by":"CKR","last_touched":1653504831,"title":"办 1000Mbps 宽带，运营商给的猫网口还是千兆口，怎么撕","url":"https://www.v2ex.com/t/855384","created":1653533631,"deleted":0,"content":"线路是 10G EPON 。运营商虽然上门来换了个新猫，但是网口还是千兆的。这样只能跑到 900 多 Mbps\r\n\r\n\r\n\r\n\r\n投诉以后，运营商说现在没有 2.5G 或者 10G 的猫。只能这样\r\n\r\n\r\n\r\n我在淘宝 闲鱼上搜了一下。带 2.5g 的猫都要 1000 块钱以上，但是千兆口的猫 2 300 就能买到。\r\n\r\n\r\n\r\n各位有办了 1000M 宽带，然后运营商给配 2.5G 猫的吗？","content_rendered":"<p>线路是 10G EPON 。运营商虽然上门来换了个新猫，但是网口还是千兆的。这样只能跑到 900 多 Mbps</p>\n<p>投诉以后，运营商说现在没有 2.5G 或者 10G 的猫。只能这样</p>\n<p>我在淘宝 闲鱼上搜了一下。带 2.5g 的猫都要 1000 块钱以上，但是千兆口的猫 2 300 就能买到。</p>\n<p>各位有办了 1000M 宽带，然后运营商给配 2.5G 猫的吗？</p>\n","last_modified":1653533631,"replies":7,"id":855384},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/f61d/6947/375_large.png?m=1650095232","name":"go","avatar_normal":"https://cdn.v2ex.com/navatar/f61d/6947/375_normal.png?m=1650095232","title":"Go 编程语言","url":"https://www.v2ex.com/go/go","topics":2286,"footer":"","header":"Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。","title_alternative":"The Go Programming Language","avatar_mini":"https://cdn.v2ex.com/navatar/f61d/6947/375_mini.png?m=1650095232","stars":3174,"aliases":[],"root":false,"id":375,"parent_node_name":"programming"},"member":{"id":579339,"username":"mstmdev","url":"https://www.v2ex.com/u/mstmdev","website":null,"twitter":"","psn":"","github":"no-src","btc":"","location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/6d58da56c288308690ff32a565be62c4?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/6d58da56c288308690ff32a565be62c4?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/6d58da56c288308690ff32a565be62c4?s=73&d=retro","created":1650907370,"last_modified":1650907370},"last_reply_by":"weak","last_touched":1653532502,"title":"用 golang 造个轮子-一款开箱即用的跨平台文件同步工具 gofs","url":"https://www.v2ex.com/t/855370","created":1653531065,"deleted":0,"content":"# gofs\r\n\r\n[![Chat]( https://img.shields.io/discord/936876326722363472)]( https://discord.gg/Ww6bXCcsgv)\r\n[![Build]( https://img.shields.io/github/workflow/status/no-src/gofs/Go)]( https://github.com/no-src/gofs/actions)\r\n[![License]( https://img.shields.io/github/license/no-src/gofs)]( https://github.com/no-src/gofs/blob/main/LICENSE)\r\n[![Go Reference]( https://pkg.go.dev/badge/github.com/no-src/gofs.svg)]( https://pkg.go.dev/github.com/no-src/gofs)\r\n[![Go Report Card]( https://goreportcard.com/badge/github.com/no-src/gofs)]( https://goreportcard.com/report/github.com/no-src/gofs)\r\n[![codecov]( https://codecov.io/gh/no-src/gofs/branch/main/graph/badge.svg?token=U5K9HV78P0)]( https://codecov.io/gh/no-src/gofs)\r\n[![Release]( https://img.shields.io/github/v/release/no-src/gofs)]( https://github.com/no-src/gofs/releases)\r\n[![Mentioned in Awesome Go]( https://awesome.re/mentioned-badge.svg)]( https://github.com/avelino/awesome-go)\r\n\r\n[English]( https://github.com/no-src/gofs) | 简体中文\r\n\r\n`gofs`是基于 golang 开发的一款开箱即用的跨平台文件同步工具，支持在本地磁盘之间同步、从远程服务器同步变更到本地、将本地文件变更推送到远程服务器三种模式。开源地址如下：[Github]( https://github.com/no-src/gofs) & [Gitee]( https://gitee.com/no-src/gofs)\r\n\r\n## 安装\r\n\r\n首先需要确保已经安装了[Go]( https://golang.google.cn/doc/install) (**版本必须是 1.18+**)，然后你就可以使用下面的命令来安装`gofs`了\r\n\r\n```bash\r\ngo install github.com/no-src/gofs/...@latest\r\n```\r\n\r\n### 在 Docker 中运行\r\n\r\n如果你想要在 docker 中运行，请在安装或者编译的时候使用`-tags netgo`命令行参数或者设置环境变量`CGO_ENABLED=0`,否则当你运行 docker 容器时可能会报找不到`gofs`的错误\r\n\r\n```bash\r\ngo install -tags netgo github.com/no-src/gofs/...@latest\r\n```\r\n\r\n你可以使用[build-docker.sh]( https://github.com/no-src/gofs/blob/main/scripts/build-docker.sh)脚本来构建 docker 镜像，首先你需要克隆本仓库并且`cd`到本仓库的根目录\r\n\r\n```bash\r\n$ ./scripts/build-docker.sh\r\n```\r\n\r\n或者使用以下命令直接从[DockerHub]( https://hub.docker.com/r/nosrc/gofs)中拉取 docker 镜像\r\n\r\n```bash\r\n$ docker pull nosrc/gofs\r\n```\r\n\r\n更多关于发布与 docker 的脚本参见[scripts]( https://github.com/no-src/gofs/blob/main/scripts)目录\r\n\r\n### 后台运行\r\n\r\n在 windows 系统中，你可以使用下面的命令构建一个在后台运行的不带命令行界面的程序\r\n\r\n```bat\r\ngo install -ldflags=\"-H windowsgui\" github.com/no-src/gofs/...@latest\r\n```\r\n\r\n## 快速开始\r\n\r\n### 先决条件\r\n\r\n请确保文件同步的源目录和目标目录都已经存在，如果目录不存在，则用你实际的目录替换下面的路径进行提前创建\r\n\r\n```bash\r\n$ mkdir source dest\r\n```\r\n\r\n生成仅用于测试的证书和密钥文件，生产中请替换为正式的证书\r\n\r\nTLS 证书和密钥文件仅用于与[Web 文件服务器]( https://github.com/no-src/gofs/blob/main/README-CN.md#web 文件服务器)和[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)进行安全通讯\r\n\r\n```bash\r\n$ go run $GOROOT/src/crypto/tls/generate_cert.go --host 127.0.0.1\r\n2021/12/30 17:21:54 wrote cert.pem\r\n2021/12/30 17:21:54 wrote key.pem\r\n```\r\n\r\n查看你的工作目录\r\n\r\n```bash\r\n$ ls\r\ncert.pem  key.pem  source  dest\r\n```\r\n\r\n### 本地磁盘\r\n\r\n监控本地源目录将变更同步到目标目录\r\n\r\n你可以使用`logically_delete`命令行参数来启用逻辑删除，从而避免误删数据\r\n\r\n设置`checkpoint_count`命令行参数来使用文件中的检查点来减少传输未修改的文件块，默认情况下`checkpoint_count=10`\r\n，这意味着它最多有`10+2`个检查点。在头部和尾部还有两个额外的检查点。第一个检查点等于`chunk_size`\r\n，它是可选的。最后一个检查点等于文件大小，这是必需的。由`checkpoint_count`设置的检查点偏移量总是大于`chunk_size`，除非文件大小小于或等于`chunk_size`，那么`checkpoint_count`\r\n将变为`0`，所以它是可选的\r\n\r\n默认情况下，如果源文件的大小和修改时间与目标文件相同，则忽略当前文件的传输。你可以使用`force_checksum`命令行参数强制启用校验和来比较文件是否相等\r\n\r\n如果你想要降低同步的频率，你可以使用`sync_delay`命令行参数来启用同步延迟，当事件数量大于等于`sync_delay_events`或者距离上次同步已经等待超过`sync_delay_time`时开始同步\r\n\r\n```bash\r\n$ gofs -source=./source -dest=./dest\r\n```\r\n\r\n### 全量同步\r\n\r\n执行一次全量同步，直接将整个源目录同步到目标目录\r\n\r\n```bash\r\n$ gofs -source=./source -dest=./dest -sync_once\r\n```\r\n\r\n### 定时同步\r\n\r\n定时执行全量同步，将整个源目录同步到目标目录\r\n\r\n```bash\r\n# 每 30 秒钟将源目录全量同步到目标目录\r\n$ gofs -source=./source -dest=./dest -sync_cron=\"*/30 * * * * *\"\r\n```\r\n\r\n### 守护进程模式\r\n\r\n启动守护进程来创建一个工作进程处理实际的任务，并将相关进程的 pid 信息记录到 pid 文件中\r\n\r\n```bash\r\n$ gofs -source=./source -dest=./dest -daemon -daemon_pid\r\n```\r\n\r\n### Web 文件服务器\r\n\r\n启动一个 Web 文件服务器用于访问远程的源目录和目标目录\r\n\r\nWeb 文件服务器默认使用 HTTPS 协议，使用`tls_cert_file`和`tls_key_file`命令行参数来指定相关的证书和密钥文件\r\n\r\n如果你不需要使用 TLS 进行安全通讯，可以通过将`tls`命令行参数指定为`false`来禁用它\r\n\r\n如果将`tls`设置为`true`，则服务器默认运行端口为`443`，反之默认端口为`80`，你可以使用`server_addr`命令行参数来自定义服务器运行端口，例如`-server_addr=\":443\"`\r\n\r\n如果你在服务器端启用`tls`命令行参数，可以通过`tls_insecure_skip_verify`命令行参数来控制客户端是否跳过验证服务器的证书链和主机名，默认为`true`\r\n\r\n出于安全考虑，你应该设置`rand_user_count`命令行参数来随机生成指定数量的用户或者通过`users`命令行参数自定义用户信息来保证数据的访问安全，禁止用户匿名访问数据\r\n\r\n如果`rand_user_count`命令行参数设置大于 0 ，则随机生成的账户密码将会打印到日志信息中，请注意查看\r\n\r\n如果你需要启用 gzip 压缩响应结果，则添加`server_compress`命令行参数，但是目前 gzip 压缩不是很快，在局域网中可能会影响传输效率\r\n\r\n```bash\r\n# 启动一个 Web 文件服务器并随机创建 3 个用户\r\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\r\n$ gofs -source=./source -dest=./dest -server -tls_cert_file=cert.pem -tls_key_file=key.pem -rand_user_count=3\r\n```\r\n\r\n### 远程磁盘服务端\r\n\r\n启动一个远程磁盘服务端作为一个远程文件数据源\r\n\r\n`source`命令行参数详见[远程磁盘服务端数据源协议]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端数据源协议)\r\n\r\n注意远程磁盘服务端的用户至少要拥有读权限，例如：`-users=\"gofs|password|r\"`\r\n\r\n你可以使用`checkpoint_count`和`sync_delay`命令行参数就跟[本地磁盘]( https://github.com/no-src/gofs/blob/main/README-CN.md#本地磁盘)一样\r\n\r\n```bash\r\n# 启动一个远程磁盘服务端\r\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\r\n# 为了安全起见，请使用复杂的账户密码来设置`users`命令行参数\r\n$ gofs -source=\"rs://127.0.0.1:8105?mode=server&local_sync_disabled=true&path=./source&fs_server=https://127.0.0.1\" -dest=./dest -users=\"gofs|password|r\" -tls_cert_file=cert.pem -tls_key_file=key.pem\r\n```\r\n\r\n### 远程磁盘客户端\r\n\r\n启动一个远程磁盘客户端将远程磁盘服务端的文件变更同步到本地目标目录\r\n\r\n`source`命令行参数详见[远程磁盘服务端数据源协议]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端数据源协议)\r\n\r\n使用`sync_once`命令行参数，可以直接将远程磁盘服务端的文件整个全量同步到本地目标目录，就跟[全量同步]( https://github.com/no-src/gofs/blob/main/README-CN.md#全量同步)一样\r\n\r\n使用`sync_cron`命令行参数，可以定时将远程磁盘服务端的文件整个全量同步到本地目标目录，就跟[定时同步]( https://github.com/no-src/gofs/blob/main/README-CN.md#定时同步)一样\r\n\r\n使用`force_checksum`命令行参数强制启用校验和来比较文件是否相等，就跟[本地磁盘](#本地磁盘)一样\r\n\r\n你可以使用`sync_delay`命令行参数就跟[本地磁盘]( https://github.com/no-src/gofs/blob/main/README-CN.md#本地磁盘)一样\r\n\r\n```bash\r\n# 启动一个远程磁盘客户端\r\n# 请将`users`命令行参数替换为上面设置的实际账户名密码\r\n$ gofs -source=\"rs://127.0.0.1:8105\" -dest=./dest -users=\"gofs|password\"\r\n```\r\n\r\n### 远程推送服务端\r\n\r\n启动一个[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)作为一个远程文件数据源，并使用`push_server`命令行参数启用远程推送服务端\r\n\r\n注意远程推送服务端的用户至少要拥有读写权限，例如：`-users=\"gofs|password|rw\"`\r\n\r\n```bash\r\n# 启动一个远程磁盘服务端并启用远程推送服务端\r\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\r\n# 为了安全起见，请使用复杂的账户密码来设置`users`命令行参数\r\n$ gofs -source=\"rs://127.0.0.1:8105?mode=server&local_sync_disabled=true&path=./source&fs_server=https://127.0.0.1\" -dest=./dest -users=\"gofs|password|rw\" -tls_cert_file=cert.pem -tls_key_file=key.pem -push_server\r\n```\r\n\r\n### 远程推送客户端\r\n\r\n启动一个远程推送客户端将本地文件变更同步到[远程推送服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程推送服务端)\r\n\r\n使用`chunk_size`命令行参数来设置大文件上传时切分的区块大小，默认值为`1048576`，即`1MB`\r\n\r\n你可以使用`checkpoint_count`和`sync_delay`命令行参数就跟[本地磁盘]( https://github.com/no-src/gofs/blob/main/README-CN.md#本地磁盘)一样\r\n\r\n更多命令行参数用法请参见[远程磁盘客户端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘客户端)\r\n\r\n```bash\r\n# 启动一个远程推送客户端并且启用本地磁盘同步，将 source 目录下的文件变更同步到本地 dest 目录和远程推送服务器上\r\n# 请将`users`命令行参数替换为上面设置的实际账户名密码\r\n$ gofs -source=\"./source\" -dest=\"rs://127.0.0.1:8105?local_sync_disabled=false&path=./dest\" -users=\"gofs|password\"\r\n```\r\n\r\n### 远程磁盘服务端数据源协议\r\n\r\n远程磁盘服务端数据源协议基于 URI 基本语法,详见[RFC 3986]( https://www.rfc-editor.org/rfc/rfc3986.html)\r\n\r\n#### 方案\r\n\r\n方案名称为`rs`\r\n\r\n#### 主机名\r\n\r\n远程磁盘服务端数据源在[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)模式下使用`0.0.0.0`或者其他本地网卡 IP 地址作为主机名，在[远程磁盘客户端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘客户端)\r\n模式下使用远程磁盘服务端的 IP 地址或者域名作为主机名\r\n\r\n#### 端口号\r\n\r\n远程磁盘服务端数据源端口号，默认为`8105`\r\n\r\n#### 参数\r\n\r\n仅在[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)模式下设置以下参数\r\n\r\n- `path` [远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)真实的本地源目录\r\n- `mode` 指定运行模式，只有在[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)模式下需要手动指定为`server`，默认为[远程磁盘客户端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘客户端)模式\r\n- `fs_server` [Web 文件服务器]( https://github.com/no-src/gofs/blob/main/README-CN.md#web 文件服务器)地址，例如`https://127.0.0.1`\r\n- `local_sync_disabled` 是否将[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)的文件变更同步到远程本地的目标目录,可选值为`true`或`false`，默认值为`false`\r\n\r\n#### 示例\r\n\r\n[远程磁盘服务端]( https://github.com/no-src/gofs/blob/main/README-CN.md#远程磁盘服务端)模式下的示例\r\n\r\n```text\r\n rs://127.0.0.1:8105?mode=server&local_sync_disabled=true&path=./source&fs_server=https://127.0.0.1\r\n \\_/  \\_______/ \\__/ \\____________________________________________________________________________/\r\n  |       |       |                                      |\r\n 方案   主机名   端口号                                    参数\r\n```\r\n\r\n### 管理接口\r\n\r\n基于[Web 文件服务器]( https://github.com/no-src/gofs/blob/main/README-CN.md#web 文件服务器)的应用管理接口\r\n\r\n默认情况下，仅允许私有地址和回环地址访问管理接口的相关路由\r\n\r\n你可以通过将`manage_private`命令行参数设置为`false`来禁用默认行为，允许公网 IP 访问管理接口的路由\r\n\r\n```bash\r\n$ gofs -source=./source -dest=./dest -server -tls_cert_file=cert.pem -tls_key_file=key.pem -rand_user_count=3 -manage\r\n```\r\n\r\n#### 性能分析接口\r\n\r\npprof 访问地址如下：\r\n\r\n```text\r\nhttps://127.0.0.1/manage/pprof/\r\n```\r\n\r\n#### 配置接口\r\n\r\n读取应用程序配置，默认返回`json`格式，当前支持`json`和`yaml`格式\r\n\r\n```text\r\nhttps://127.0.0.1/manage/config\r\n```\r\n\r\n或者使用`format`参数来指定返回的配置格式\r\n\r\n```text\r\nhttps://127.0.0.1/manage/config?format=yaml\r\n```\r\n\r\n#### 报告接口\r\n\r\n使用`report`命令行参数来启用报告接口的路由并且开始收集报告数据，需要先启用`manage`命令行参数\r\n\r\n报告接口详情参见[Report API](/server/README.md#report-api)\r\n\r\n```text\r\nhttps://127.0.0.1/manage/report\r\n```\r\n\r\n### 日志\r\n\r\n默认情况下会启用文件日志与控制台日志，你可以将`log_file`命令行参数设置为`false`来禁用文件日志\r\n\r\n使用`log_level`命令行参数设置日志的等级，默认级别是`INFO`，可选项为：`DEBUG=0` `INFO=1` `WARN=2` `ERROR=3`\r\n\r\n使用`log_dir`命令行参数来设置日志文件目录，默认为`./logs/`\r\n\r\n使用`log_flush`命令行参数来设置自动刷新日志到文件中，默认启用\r\n\r\n使用`log_flush_interval`命令行参数设置自动刷新日志到文件中的频率，默认为`3s`\r\n\r\n使用`log_event`命令行参数启用事件日志，所有事件都会记录到文件中，默认为禁用\r\n\r\n使用`log_sample_rate`命令行参数设置采样日志的采样率，取值范围为 0 到 1 ，默认值为`1`\r\n\r\n```bash\r\n# 在\"本地磁盘\"模式下设置日志信息\r\n$ gofs -source=./source -dest=./dest -log_file -log_level=0 -log_dir=\"./logs/\" -log_flush -log_flush_interval=3s -log_event\r\n```\r\n\r\n### 使用配置文件\r\n\r\n如果需要的话，你可以使用配置文件来代替所有的命令行参数，当前支持`json`和`yaml`格式\r\n\r\n所有的配置字段名称跟命令行参数一样，你可以参考[配置示例](/conf/example)或者[配置接口]( https://github.com/no-src/gofs/blob/main/README-CN.md#配置接口)的响应结果\r\n\r\n```bash\r\n$ gofs -conf=./gofs.yaml\r\n```\r\n\r\n### 校验和\r\n\r\n你可以使用`checksum`命令行参数来计算并打印文件的校验和\r\n\r\n`chunk_size`和`checkpoint_count`命令行参数在这里同在[本地磁盘]( https://github.com/no-src/gofs/blob/main/README-CN.md#本地磁盘)中一样有效\r\n\r\n```bash\r\n$ gofs -source=./gofs -checksum\r\n```\r\n\r\n## 更多信息\r\n\r\n### 帮助信息\r\n\r\n```bash\r\n$ gofs -h\r\n```\r\n\r\n### 版本信息\r\n\r\n```bash\r\n$ gofs -v\r\n```\r\n\r\n### 关于信息\r\n\r\n```bash\r\n$ gofs -about\r\n```","content_rendered":"<h1>gofs</h1>\n<p><a href=\"https://discord.gg/Ww6bXCcsgv\" rel=\"nofollow\"><img alt=\"Chat\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.shields.io/discord/936876326722363472\"/></a>\n<a href=\"https://github.com/no-src/gofs/actions\" rel=\"nofollow\"><img alt=\"Build\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.shields.io/github/workflow/status/no-src/gofs/Go\"/></a>\n<a href=\"https://github.com/no-src/gofs/blob/main/LICENSE\" rel=\"nofollow\"><img alt=\"License\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.shields.io/github/license/no-src/gofs\"/></a>\n<a href=\"https://pkg.go.dev/github.com/no-src/gofs\" rel=\"nofollow\"><img alt=\"Go Reference\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://pkg.go.dev/badge/github.com/no-src/gofs.svg\"/></a>\n<a href=\"https://goreportcard.com/report/github.com/no-src/gofs\" rel=\"nofollow\"><img alt=\"Go Report Card\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://goreportcard.com/badge/github.com/no-src/gofs\"/></a>\n<a href=\"https://codecov.io/gh/no-src/gofs\" rel=\"nofollow\"><img alt=\"codecov\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://codecov.io/gh/no-src/gofs/branch/main/graph/badge.svg?token=U5K9HV78P0\"/></a>\n<a href=\"https://github.com/no-src/gofs/releases\" rel=\"nofollow\"><img alt=\"Release\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.shields.io/github/v/release/no-src/gofs\"/></a>\n<a href=\"https://github.com/avelino/awesome-go\" rel=\"nofollow\"><img alt=\"Mentioned in Awesome Go\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://awesome.re/mentioned-badge.svg\"/></a></p>\n<p><a href=\"https://github.com/no-src/gofs\" rel=\"nofollow\">English</a> | 简体中文</p>\n<p><code>gofs</code>是基于 golang 开发的一款开箱即用的跨平台文件同步工具，支持在本地磁盘之间同步、从远程服务器同步变更到本地、将本地文件变更推送到远程服务器三种模式。开源地址如下：<a href=\"https://github.com/no-src/gofs\" rel=\"nofollow\">Github</a> &amp; <a href=\"https://gitee.com/no-src/gofs\" rel=\"nofollow\">Gitee</a></p>\n<h2>安装</h2>\n<p>首先需要确保已经安装了<a href=\"https://golang.google.cn/doc/install\" rel=\"nofollow\">Go</a> (<strong>版本必须是 1.18+</strong>)，然后你就可以使用下面的命令来安装<code>gofs</code>了</p>\n<pre><code class=\"language-bash\">go install github.com/no-src/gofs/...@latest\n</code></pre>\n<h3>在 Docker 中运行</h3>\n<p>如果你想要在 docker 中运行，请在安装或者编译的时候使用<code>-tags netgo</code>命令行参数或者设置环境变量<code>CGO_ENABLED=0</code>,否则当你运行 docker 容器时可能会报找不到<code>gofs</code>的错误</p>\n<pre><code class=\"language-bash\">go install -tags netgo github.com/no-src/gofs/...@latest\n</code></pre>\n<p>你可以使用<a href=\"https://github.com/no-src/gofs/blob/main/scripts/build-docker.sh\" rel=\"nofollow\">build-docker.sh</a>脚本来构建 docker 镜像，首先你需要克隆本仓库并且<code>cd</code>到本仓库的根目录</p>\n<pre><code class=\"language-bash\">$ ./scripts/build-docker.sh\n</code></pre>\n<p>或者使用以下命令直接从<a href=\"https://hub.docker.com/r/nosrc/gofs\" rel=\"nofollow\">DockerHub</a>中拉取 docker 镜像</p>\n<pre><code class=\"language-bash\">$ docker pull nosrc/gofs\n</code></pre>\n<p>更多关于发布与 docker 的脚本参见<a href=\"https://github.com/no-src/gofs/blob/main/scripts\" rel=\"nofollow\">scripts</a>目录</p>\n<h3>后台运行</h3>\n<p>在 windows 系统中，你可以使用下面的命令构建一个在后台运行的不带命令行界面的程序</p>\n<pre><code class=\"language-bat\">go install -ldflags=\"-H windowsgui\" github.com/no-src/gofs/...@latest\n</code></pre>\n<h2>快速开始</h2>\n<h3>先决条件</h3>\n<p>请确保文件同步的源目录和目标目录都已经存在，如果目录不存在，则用你实际的目录替换下面的路径进行提前创建</p>\n<pre><code class=\"language-bash\">$ mkdir source dest\n</code></pre>\n<p>生成仅用于测试的证书和密钥文件，生产中请替换为正式的证书</p>\n<p>TLS 证书和密钥文件仅用于与[Web 文件服务器]( <a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#web\" rel=\"nofollow\">https://github.com/no-src/gofs/blob/main/README-CN.md#web</a> 文件服务器)和<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>进行安全通讯</p>\n<pre><code class=\"language-bash\">$ go run $GOROOT/src/crypto/tls/generate_cert.go --host 127.0.0.1\n2021/12/30 17:21:54 wrote cert.pem\n2021/12/30 17:21:54 wrote key.pem\n</code></pre>\n<p>查看你的工作目录</p>\n<pre><code class=\"language-bash\">$ ls\ncert.pem  key.pem  source  dest\n</code></pre>\n<h3>本地磁盘</h3>\n<p>监控本地源目录将变更同步到目标目录</p>\n<p>你可以使用<code>logically_delete</code>命令行参数来启用逻辑删除，从而避免误删数据</p>\n<p>设置<code>checkpoint_count</code>命令行参数来使用文件中的检查点来减少传输未修改的文件块，默认情况下<code>checkpoint_count=10</code>\n，这意味着它最多有<code>10+2</code>个检查点。在头部和尾部还有两个额外的检查点。第一个检查点等于<code>chunk_size</code>\n，它是可选的。最后一个检查点等于文件大小，这是必需的。由<code>checkpoint_count</code>设置的检查点偏移量总是大于<code>chunk_size</code>，除非文件大小小于或等于<code>chunk_size</code>，那么<code>checkpoint_count</code>\n将变为<code>0</code>，所以它是可选的</p>\n<p>默认情况下，如果源文件的大小和修改时间与目标文件相同，则忽略当前文件的传输。你可以使用<code>force_checksum</code>命令行参数强制启用校验和来比较文件是否相等</p>\n<p>如果你想要降低同步的频率，你可以使用<code>sync_delay</code>命令行参数来启用同步延迟，当事件数量大于等于<code>sync_delay_events</code>或者距离上次同步已经等待超过<code>sync_delay_time</code>时开始同步</p>\n<pre><code class=\"language-bash\">$ gofs -source=./source -dest=./dest\n</code></pre>\n<h3>全量同步</h3>\n<p>执行一次全量同步，直接将整个源目录同步到目标目录</p>\n<pre><code class=\"language-bash\">$ gofs -source=./source -dest=./dest -sync_once\n</code></pre>\n<h3>定时同步</h3>\n<p>定时执行全量同步，将整个源目录同步到目标目录</p>\n<pre><code class=\"language-bash\"># 每 30 秒钟将源目录全量同步到目标目录\n$ gofs -source=./source -dest=./dest -sync_cron=\"*/30 * * * * *\"\n</code></pre>\n<h3>守护进程模式</h3>\n<p>启动守护进程来创建一个工作进程处理实际的任务，并将相关进程的 pid 信息记录到 pid 文件中</p>\n<pre><code class=\"language-bash\">$ gofs -source=./source -dest=./dest -daemon -daemon_pid\n</code></pre>\n<h3>Web 文件服务器</h3>\n<p>启动一个 Web 文件服务器用于访问远程的源目录和目标目录</p>\n<p>Web 文件服务器默认使用 HTTPS 协议，使用<code>tls_cert_file</code>和<code>tls_key_file</code>命令行参数来指定相关的证书和密钥文件</p>\n<p>如果你不需要使用 TLS 进行安全通讯，可以通过将<code>tls</code>命令行参数指定为<code>false</code>来禁用它</p>\n<p>如果将<code>tls</code>设置为<code>true</code>，则服务器默认运行端口为<code>443</code>，反之默认端口为<code>80</code>，你可以使用<code>server_addr</code>命令行参数来自定义服务器运行端口，例如<code>-server_addr=\":443\"</code></p>\n<p>如果你在服务器端启用<code>tls</code>命令行参数，可以通过<code>tls_insecure_skip_verify</code>命令行参数来控制客户端是否跳过验证服务器的证书链和主机名，默认为<code>true</code></p>\n<p>出于安全考虑，你应该设置<code>rand_user_count</code>命令行参数来随机生成指定数量的用户或者通过<code>users</code>命令行参数自定义用户信息来保证数据的访问安全，禁止用户匿名访问数据</p>\n<p>如果<code>rand_user_count</code>命令行参数设置大于 0 ，则随机生成的账户密码将会打印到日志信息中，请注意查看</p>\n<p>如果你需要启用 gzip 压缩响应结果，则添加<code>server_compress</code>命令行参数，但是目前 gzip 压缩不是很快，在局域网中可能会影响传输效率</p>\n<pre><code class=\"language-bash\"># 启动一个 Web 文件服务器并随机创建 3 个用户\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\n$ gofs -source=./source -dest=./dest -server -tls_cert_file=cert.pem -tls_key_file=key.pem -rand_user_count=3\n</code></pre>\n<h3>远程磁盘服务端</h3>\n<p>启动一个远程磁盘服务端作为一个远程文件数据源</p>\n<p><code>source</code>命令行参数详见<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%95%B0%E6%8D%AE%E6%BA%90%E5%8D%8F%E8%AE%AE\" rel=\"nofollow\">远程磁盘服务端数据源协议</a></p>\n<p>注意远程磁盘服务端的用户至少要拥有读权限，例如：<code>-users=\"gofs|password|r\"</code></p>\n<p>你可以使用<code>checkpoint_count</code>和<code>sync_delay</code>命令行参数就跟<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98\" rel=\"nofollow\">本地磁盘</a>一样</p>\n<pre><code class=\"language-bash\"># 启动一个远程磁盘服务端\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\n# 为了安全起见，请使用复杂的账户密码来设置`users`命令行参数\n$ gofs -source=\"rs://127.0.0.1:8105?mode=server&amp;local_sync_disabled=true&amp;path=./source&amp;fs_server=https://127.0.0.1\" -dest=./dest -users=\"gofs|password|r\" -tls_cert_file=cert.pem -tls_key_file=key.pem\n</code></pre>\n<h3>远程磁盘客户端</h3>\n<p>启动一个远程磁盘客户端将远程磁盘服务端的文件变更同步到本地目标目录</p>\n<p><code>source</code>命令行参数详见<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%95%B0%E6%8D%AE%E6%BA%90%E5%8D%8F%E8%AE%AE\" rel=\"nofollow\">远程磁盘服务端数据源协议</a></p>\n<p>使用<code>sync_once</code>命令行参数，可以直接将远程磁盘服务端的文件整个全量同步到本地目标目录，就跟<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E5%85%A8%E9%87%8F%E5%90%8C%E6%AD%A5\" rel=\"nofollow\">全量同步</a>一样</p>\n<p>使用<code>sync_cron</code>命令行参数，可以定时将远程磁盘服务端的文件整个全量同步到本地目标目录，就跟<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E5%AE%9A%E6%97%B6%E5%90%8C%E6%AD%A5\" rel=\"nofollow\">定时同步</a>一样</p>\n<p>使用<code>force_checksum</code>命令行参数强制启用校验和来比较文件是否相等，就跟<a href=\"#%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98\" rel=\"nofollow\">本地磁盘</a>一样</p>\n<p>你可以使用<code>sync_delay</code>命令行参数就跟<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98\" rel=\"nofollow\">本地磁盘</a>一样</p>\n<pre><code class=\"language-bash\"># 启动一个远程磁盘客户端\n# 请将`users`命令行参数替换为上面设置的实际账户名密码\n$ gofs -source=\"rs://127.0.0.1:8105\" -dest=./dest -users=\"gofs|password\"\n</code></pre>\n<h3>远程推送服务端</h3>\n<p>启动一个<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>作为一个远程文件数据源，并使用<code>push_server</code>命令行参数启用远程推送服务端</p>\n<p>注意远程推送服务端的用户至少要拥有读写权限，例如：<code>-users=\"gofs|password|rw\"</code></p>\n<pre><code class=\"language-bash\"># 启动一个远程磁盘服务端并启用远程推送服务端\n# 在生产环境中请将`tls_cert_file`和`tls_key_file`命令行参数替换为正式的证书和密钥文件\n# 为了安全起见，请使用复杂的账户密码来设置`users`命令行参数\n$ gofs -source=\"rs://127.0.0.1:8105?mode=server&amp;local_sync_disabled=true&amp;path=./source&amp;fs_server=https://127.0.0.1\" -dest=./dest -users=\"gofs|password|rw\" -tls_cert_file=cert.pem -tls_key_file=key.pem -push_server\n</code></pre>\n<h3>远程推送客户端</h3>\n<p>启动一个远程推送客户端将本地文件变更同步到<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E6%8E%A8%E9%80%81%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程推送服务端</a></p>\n<p>使用<code>chunk_size</code>命令行参数来设置大文件上传时切分的区块大小，默认值为<code>1048576</code>，即<code>1MB</code></p>\n<p>你可以使用<code>checkpoint_count</code>和<code>sync_delay</code>命令行参数就跟<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98\" rel=\"nofollow\">本地磁盘</a>一样</p>\n<p>更多命令行参数用法请参见<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E5%AE%A2%E6%88%B7%E7%AB%AF\" rel=\"nofollow\">远程磁盘客户端</a></p>\n<pre><code class=\"language-bash\"># 启动一个远程推送客户端并且启用本地磁盘同步，将 source 目录下的文件变更同步到本地 dest 目录和远程推送服务器上\n# 请将`users`命令行参数替换为上面设置的实际账户名密码\n$ gofs -source=\"./source\" -dest=\"rs://127.0.0.1:8105?local_sync_disabled=false&amp;path=./dest\" -users=\"gofs|password\"\n</code></pre>\n<h3>远程磁盘服务端数据源协议</h3>\n<p>远程磁盘服务端数据源协议基于 URI 基本语法,详见<a href=\"https://www.rfc-editor.org/rfc/rfc3986.html\" rel=\"nofollow\">RFC 3986</a></p>\n<h4>方案</h4>\n<p>方案名称为<code>rs</code></p>\n<h4>主机名</h4>\n<p>远程磁盘服务端数据源在<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>模式下使用<code>0.0.0.0</code>或者其他本地网卡 IP 地址作为主机名，在<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E5%AE%A2%E6%88%B7%E7%AB%AF\" rel=\"nofollow\">远程磁盘客户端</a>\n模式下使用远程磁盘服务端的 IP 地址或者域名作为主机名</p>\n<h4>端口号</h4>\n<p>远程磁盘服务端数据源端口号，默认为<code>8105</code></p>\n<h4>参数</h4>\n<p>仅在<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>模式下设置以下参数</p>\n<ul>\n<li><code>path</code> <a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>真实的本地源目录</li>\n<li><code>mode</code> 指定运行模式，只有在<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>模式下需要手动指定为<code>server</code>，默认为<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E5%AE%A2%E6%88%B7%E7%AB%AF\" rel=\"nofollow\">远程磁盘客户端</a>模式</li>\n<li><code>fs_server</code> [Web 文件服务器]( <a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#web\" rel=\"nofollow\">https://github.com/no-src/gofs/blob/main/README-CN.md#web</a> 文件服务器)地址，例如<code>https://127.0.0.1</code></li>\n<li><code>local_sync_disabled</code> 是否将<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>的文件变更同步到远程本地的目标目录,可选值为<code>true</code>或<code>false</code>，默认值为<code>false</code></li>\n</ul>\n<h4>示例</h4>\n<p><a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E8%BF%9C%E7%A8%8B%E7%A3%81%E7%9B%98%E6%9C%8D%E5%8A%A1%E7%AB%AF\" rel=\"nofollow\">远程磁盘服务端</a>模式下的示例</p>\n<pre><code class=\"language-text\"> rs://127.0.0.1:8105?mode=server&amp;local_sync_disabled=true&amp;path=./source&amp;fs_server=https://127.0.0.1\n \\_/  \\_______/ \\__/ \\____________________________________________________________________________/\n  |       |       |                                      |\n 方案   主机名   端口号                                    参数\n</code></pre>\n<h3>管理接口</h3>\n<p>基于[Web 文件服务器]( <a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#web\" rel=\"nofollow\">https://github.com/no-src/gofs/blob/main/README-CN.md#web</a> 文件服务器)的应用管理接口</p>\n<p>默认情况下，仅允许私有地址和回环地址访问管理接口的相关路由</p>\n<p>你可以通过将<code>manage_private</code>命令行参数设置为<code>false</code>来禁用默认行为，允许公网 IP 访问管理接口的路由</p>\n<pre><code class=\"language-bash\">$ gofs -source=./source -dest=./dest -server -tls_cert_file=cert.pem -tls_key_file=key.pem -rand_user_count=3 -manage\n</code></pre>\n<h4>性能分析接口</h4>\n<p>pprof 访问地址如下：</p>\n<pre><code class=\"language-text\">https://127.0.0.1/manage/pprof/\n</code></pre>\n<h4>配置接口</h4>\n<p>读取应用程序配置，默认返回<code>json</code>格式，当前支持<code>json</code>和<code>yaml</code>格式</p>\n<pre><code class=\"language-text\">https://127.0.0.1/manage/config\n</code></pre>\n<p>或者使用<code>format</code>参数来指定返回的配置格式</p>\n<pre><code class=\"language-text\">https://127.0.0.1/manage/config?format=yaml\n</code></pre>\n<h4>报告接口</h4>\n<p>使用<code>report</code>命令行参数来启用报告接口的路由并且开始收集报告数据，需要先启用<code>manage</code>命令行参数</p>\n<p>报告接口详情参见<a href=\"/server/README.md#report-api\" rel=\"nofollow\">Report API</a></p>\n<pre><code class=\"language-text\">https://127.0.0.1/manage/report\n</code></pre>\n<h3>日志</h3>\n<p>默认情况下会启用文件日志与控制台日志，你可以将<code>log_file</code>命令行参数设置为<code>false</code>来禁用文件日志</p>\n<p>使用<code>log_level</code>命令行参数设置日志的等级，默认级别是<code>INFO</code>，可选项为：<code>DEBUG=0</code> <code>INFO=1</code> <code>WARN=2</code> <code>ERROR=3</code></p>\n<p>使用<code>log_dir</code>命令行参数来设置日志文件目录，默认为<code>./logs/</code></p>\n<p>使用<code>log_flush</code>命令行参数来设置自动刷新日志到文件中，默认启用</p>\n<p>使用<code>log_flush_interval</code>命令行参数设置自动刷新日志到文件中的频率，默认为<code>3s</code></p>\n<p>使用<code>log_event</code>命令行参数启用事件日志，所有事件都会记录到文件中，默认为禁用</p>\n<p>使用<code>log_sample_rate</code>命令行参数设置采样日志的采样率，取值范围为 0 到 1 ，默认值为<code>1</code></p>\n<pre><code class=\"language-bash\"># 在\"本地磁盘\"模式下设置日志信息\n$ gofs -source=./source -dest=./dest -log_file -log_level=0 -log_dir=\"./logs/\" -log_flush -log_flush_interval=3s -log_event\n</code></pre>\n<h3>使用配置文件</h3>\n<p>如果需要的话，你可以使用配置文件来代替所有的命令行参数，当前支持<code>json</code>和<code>yaml</code>格式</p>\n<p>所有的配置字段名称跟命令行参数一样，你可以参考<a href=\"/conf/example\" rel=\"nofollow\">配置示例</a>或者<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E9%85%8D%E7%BD%AE%E6%8E%A5%E5%8F%A3\" rel=\"nofollow\">配置接口</a>的响应结果</p>\n<pre><code class=\"language-bash\">$ gofs -conf=./gofs.yaml\n</code></pre>\n<h3>校验和</h3>\n<p>你可以使用<code>checksum</code>命令行参数来计算并打印文件的校验和</p>\n<p><code>chunk_size</code>和<code>checkpoint_count</code>命令行参数在这里同在<a href=\"https://github.com/no-src/gofs/blob/main/README-CN.md#%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98\" rel=\"nofollow\">本地磁盘</a>中一样有效</p>\n<pre><code class=\"language-bash\">$ gofs -source=./gofs -checksum\n</code></pre>\n<h2>更多信息</h2>\n<h3>帮助信息</h3>\n<pre><code class=\"language-bash\">$ gofs -h\n</code></pre>\n<h3>版本信息</h3>\n<pre><code class=\"language-bash\">$ gofs -v\n</code></pre>\n<h3>关于信息</h3>\n<pre><code class=\"language-bash\">$ gofs -about\n</code></pre>\n","last_modified":1653531533,"replies":7,"id":855370},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185187,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":302075,"username":"MCyunpeng98","url":"https://www.v2ex.com/u/MCyunpeng98","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/29e1ca4d17953bade550ef1631776d4c?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/29e1ca4d17953bade550ef1631776d4c?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/29e1ca4d17953bade550ef1631776d4c?s=73&d=retro","created":1521610981,"last_modified":1521610981},"last_reply_by":"MCyunpeng98","last_touched":1653534466,"title":"求推荐一款安装手机浏览器","url":"https://www.v2ex.com/t/855367","created":1653530943,"deleted":0,"content":"需求：\r\n1.国内某些 app 访问一些链接会出现\"根据监管部门规定以及投诉举报，此链接违反相关法律法规，禁止访问\"这样的提示，有没有不会出现这样的提示的呀。\r\n2.观看网页视频的时候可以点击下载。\r\n3.有简洁模式，不想看那种动不动震惊的新闻。\r\n4.其实夸克挺好的，就是现在会屏蔽链接，又绕不过去。","content_rendered":"<p>需求：\n1.国内某些 app 访问一些链接会出现\"根据监管部门规定以及投诉举报，此链接违反相关法律法规，禁止访问\"这样的提示，有没有不会出现这样的提示的呀。\n2.观看网页视频的时候可以点击下载。\n3.有简洁模式，不想看那种动不动震惊的新闻。\n4.其实夸克挺好的，就是现在会屏蔽链接，又绕不过去。</p>\n","last_modified":1653530943,"replies":7,"id":855367},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":185185,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3483,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":402759,"username":"unclemcz","url":"https://www.v2ex.com/u/unclemcz","website":"https://www.wotiku.cn","twitter":"","psn":"","github":"unclemcz","btc":"","location":"温州","tagline":"做个对社会有价值的人。","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/9b2e/d2c2/402759_mini.png?m=1632837860","avatar_normal":"https://cdn.v2ex.com/avatar/9b2e/d2c2/402759_normal.png?m=1632837860","avatar_large":"https://cdn.v2ex.com/avatar/9b2e/d2c2/402759_large.png?m=1632837860","created":1555550517,"last_modified":1632837860},"last_reply_by":"jfj8848","last_touched":1653464469,"title":"彦祖们，有没有开源可私有化部署的文档协作管理软件推荐的？","url":"https://www.v2ex.com/t/855358","created":1653529579,"deleted":0,"content":"使用目的：用于项目全周期的资料管理；\r\n网络环境：内部局域网；\r\n其他：对 word 、wps 在线编辑等没有要求，最好可支持 markdown （非必须）。","content_rendered":"使用目的：用于项目全周期的资料管理；<br />网络环境：内部局域网；<br />其他：对 word 、wps 在线编辑等没有要求，最好可支持 markdown （非必须）。","last_modified":1653529579,"replies":7,"id":855358},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/74bb/a227/938_large.png?m=1591791660","name":"gts","avatar_normal":"https://cdn.v2ex.com/navatar/74bb/a227/938_normal.png?m=1591791660","title":"全球工单系统","url":"https://www.v2ex.com/go/gts","topics":8940,"footer":"","header":"希望这里能够为你遇到的问题找到解决方案","title_alternative":"Global Ticket System","avatar_mini":"https://cdn.v2ex.com/navatar/74bb/a227/938_mini.png?m=1591791660","stars":1675,"aliases":[],"root":false,"id":938,"parent_node_name":"geek"},"member":{"id":76329,"username":"xiaoz","url":"https://www.v2ex.com/u/xiaoz","website":"https://www.xiaoz.me/","twitter":"","psn":"","github":"helloxz","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/5f76/7779/76329_mini.png?m=1639131818","avatar_normal":"https://cdn.v2ex.com/avatar/5f76/7779/76329_normal.png?m=1639131818","avatar_large":"https://cdn.v2ex.com/avatar/5f76/7779/76329_large.png?m=1639131818","created":1412777376,"last_modified":1639131818},"last_reply_by":"sogwsc","last_touched":1653535932,"title":"QQ 又被以所谓的“涉嫌诈骗”为由封了","url":"https://www.v2ex.com/t/855371","created":1653531492,"deleted":0,"content":"正在和客户正常聊天沟通，提到了关键词支付宝，然后马上就下线被封了，依然是以“涉嫌诈骗”为由。\r\n\r\n![]( https://img.rss.ink/imgs/2022/05/26/adb7ee05d3eece0b.png)\r\n\r\n![]( https://img.rss.ink/imgs/2022/05/26/24492780d35ed7d5.jpg)\r\n\r\n![]( https://img.rss.ink/imgs/2022/05/26/716d732c949b5243.jpg)\r\n\r\n这次比较狠一点，申诉入口也不给我了，发了一条微博本来打算推广一下。\r\n\r\n![]( https://img.rss.ink/imgs/2022/05/26/62cff24cdeab8629.png)\r\n\r\n花了钱进行微博推广，然后没几分钟，微博把钱也退回来了，果然都是穿一条裤子的，用户连开口说话的机会都没有，然后微博还被限流了。\r\n\r\n![]( https://img.rss.ink/imgs/2022/05/26/bf7bd94cbd7802ee.png)\r\n\r\n请问这种情况可以起诉腾讯吗？","content_rendered":"<p>正在和客户正常聊天沟通，提到了关键词支付宝，然后马上就下线被封了，依然是以“涉嫌诈骗”为由。</p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.rss.ink/imgs/2022/05/26/adb7ee05d3eece0b.png\"/></p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.rss.ink/imgs/2022/05/26/24492780d35ed7d5.jpg\"/></p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.rss.ink/imgs/2022/05/26/716d732c949b5243.jpg\"/></p>\n<p>这次比较狠一点，申诉入口也不给我了，发了一条微博本来打算推广一下。</p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.rss.ink/imgs/2022/05/26/62cff24cdeab8629.png\"/></p>\n<p>花了钱进行微博推广，然后没几分钟，微博把钱也退回来了，果然都是穿一条裤子的，用户连开口说话的机会都没有，然后微博还被限流了。</p>\n<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://img.rss.ink/imgs/2022/05/26/bf7bd94cbd7802ee.png\"/></p>\n<p>请问这种情况可以起诉腾讯吗？</p>\n","last_modified":1653531521,"replies":6,"id":855371}]