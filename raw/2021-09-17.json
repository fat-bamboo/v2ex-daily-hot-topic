[{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/5422/9abf/91_large.png?m=1579186267","name":"firefox","avatar_normal":"https://cdn.v2ex.com/navatar/5422/9abf/91_normal.png?m=1579186267","title":"Firefox","url":"https://www.v2ex.com/go/firefox","topics":410,"footer":"","header":"Mozilla Firefox is a free and open source web browser.","title_alternative":"Firefox","avatar_mini":"https://cdn.v2ex.com/navatar/5422/9abf/91_mini.png?m=1579186267","stars":357,"aliases":[],"root":false,"id":91,"parent_node_name":"browsers"},"member":{"username":"byaiu","website":"","github":"","psn":"","avatar_normal":"https://cdn.v2ex.com/gravatar/70b7a34c2c62e6171762fb875da61142?s=24&d=retro","bio":"","url":"https://www.v2ex.com/u/byaiu","tagline":"","twitter":"","created":1473477980,"avatar_large":"https://cdn.v2ex.com/gravatar/70b7a34c2c62e6171762fb875da61142?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/70b7a34c2c62e6171762fb875da61142?s=24&d=retro","location":"","btc":"","id":191163},"last_reply_by":"lindas","last_touched":1631847702,"title":"Firefox 正在失去它最后的拥趸","url":"https://www.v2ex.com/t/802450","created":1631841004,"content":"今天早上打开 iOS 的火狐手机浏览器，首页被窜改成了火狐中国的垃圾堆。\n\n这充分显示了国内火狐推广的傲慢，对它最基石的用户竖起了中指：你，我毫不在乎。","content_rendered":"<p>今天早上打开 iOS 的火狐手机浏览器，首页被窜改成了火狐中国的垃圾堆。</p>\n<p>这充分显示了国内火狐推广的傲慢，对它最基石的用户竖起了中指：你，我毫不在乎。</p>\n","last_modified":1631844189,"replies":42,"id":802450},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c74d/97b0/16_large.png?m=1628872984","name":"share","avatar_normal":"https://cdn.v2ex.com/navatar/c74d/97b0/16_normal.png?m=1628872984","title":"分享发现","url":"https://www.v2ex.com/go/share","topics":34354,"footer":"","header":"分享你看到的好玩的，有信息量的，欢迎从这里获取灵感。","title_alternative":"Share","avatar_mini":"https://cdn.v2ex.com/navatar/c74d/97b0/16_mini.png?m=1628872984","stars":4588,"aliases":[],"root":false,"id":16,"parent_node_name":"v2ex"},"member":{"username":"bagheer","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/4a7e/b755/498303_mini.png?m=1594218638","bio":null,"url":"https://www.v2ex.com/u/bagheer","tagline":null,"twitter":null,"created":1594217689,"avatar_large":"https://cdn.v2ex.com/avatar/4a7e/b755/498303_mini.png?m=1594218638","avatar_mini":"https://cdn.v2ex.com/avatar/4a7e/b755/498303_mini.png?m=1594218638","location":null,"btc":null,"id":498303},"last_reply_by":"moonkiller","last_touched":1631848955,"title":"今天,微信等 app 要支持合法外链了!","url":"https://www.v2ex.com/t/802447","created":1631840497,"content":"是不是发布新版本,还是服务器端直接解封???","content_rendered":"是不是发布新版本,还是服务器端直接解封???","last_modified":1631840497,"replies":40,"id":802447},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913","name":"apple","avatar_normal":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913","title":"Apple","url":"https://www.v2ex.com/go/apple","topics":15814,"footer":"","header":"设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。","title_alternative":"Apple","avatar_mini":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913","stars":1921,"aliases":[],"root":false,"id":184,"parent_node_name":"hardware"},"member":{"username":"wisetc","website":"","github":"","psn":"","avatar_normal":"https://cdn.v2ex.com/avatar/f5d7/5ddb/200271_mini.png?m=1611475936","bio":"","url":"https://www.v2ex.com/u/wisetc","tagline":"大风车愉快的旋转...","twitter":"","created":1478512942,"avatar_large":"https://cdn.v2ex.com/avatar/f5d7/5ddb/200271_mini.png?m=1611475936","avatar_mini":"https://cdn.v2ex.com/avatar/f5d7/5ddb/200271_mini.png?m=1611475936","location":"","btc":"","id":200271},"last_reply_by":"xiaooloong","last_touched":1631847523,"title":"Apple 公司的 iPhone 好厉害","url":"https://www.v2ex.com/t/802444","created":1631839088,"content":"我用手从水平面升起 iPhonex+1 到我眼前，然后它就自动点亮了。我用腿做同样的动作，他却没有点亮。此 iPhone 它不仅能在我暗屏时看到我，他还能区分是如何将他升起的。👍","content_rendered":"我用手从水平面升起 iPhonex+1 到我眼前，然后它就自动点亮了。我用腿做同样的动作，他却没有点亮。此 iPhone 它不仅能在我暗屏时看到我，他还能区分是如何将他升起的。👍","last_modified":1631839088,"replies":22,"id":802444},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913","name":"apple","avatar_normal":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913","title":"Apple","url":"https://www.v2ex.com/go/apple","topics":15814,"footer":"","header":"设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。","title_alternative":"Apple","avatar_mini":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913","stars":1921,"aliases":[],"root":false,"id":184,"parent_node_name":"hardware"},"member":{"username":"xenme","website":"https://xenme.com","github":"xenme","psn":"","avatar_normal":"https://cdn.v2ex.com/gravatar/19f41ad7f989230efe1943b388cad324?s=24&d=retro","bio":"","url":"https://www.v2ex.com/u/xenme","tagline":"","twitter":"","created":1402284822,"avatar_large":"https://cdn.v2ex.com/gravatar/19f41ad7f989230efe1943b388cad324?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/19f41ad7f989230efe1943b388cad324?s=24&d=retro","location":"","btc":"","id":64558},"last_reply_by":"peacelove","last_touched":1631847644,"title":"早上才发现 Apple Store 官网买的 12 Pro Max 没有年年焕新","url":"https://www.v2ex.com/t/802461","created":1631843129,"content":"准备晚上换 13，然后电话问了下 Apple，被告知，去年 Apple Store 官网购买的手机和 AC+居然没有年年焕新计划。\r\n\r\n走 trade in 的话要不比年年焕新的半价亏好几百。\r\n\r\n以前都是店里买的，理所当然的以为官网商店是一样的，被坑了。","content_rendered":"<p>准备晚上换 13，然后电话问了下 Apple，被告知，去年 Apple Store 官网购买的手机和 AC+居然没有年年焕新计划。</p>\n<p>走 trade in 的话要不比年年焕新的半价亏好几百。</p>\n<p>以前都是店里买的，理所当然的以为官网商店是一样的，被坑了。</p>\n","last_modified":1631843129,"replies":20,"id":802461},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/e7b2/4b11/360_large.png?m=1583044904","name":"windows","avatar_normal":"https://cdn.v2ex.com/navatar/e7b2/4b11/360_normal.png?m=1583044904","title":"Windows","url":"https://www.v2ex.com/go/windows","topics":2211,"footer":"","header":"Windows, not walls.","title_alternative":"Windows","avatar_mini":"https://cdn.v2ex.com/navatar/e7b2/4b11/360_mini.png?m=1583044904","stars":738,"aliases":[],"root":false,"id":360,"parent_node_name":"os"},"member":{"username":"1arry","website":"","github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/64a5/3d53/544091_mini.png?m=1630044215","bio":"我的联系方式：https://bit.ly/3yDOW0J","url":"https://www.v2ex.com/u/1arry","tagline":"","twitter":null,"created":1619665827,"avatar_large":"https://cdn.v2ex.com/avatar/64a5/3d53/544091_mini.png?m=1630044215","avatar_mini":"https://cdn.v2ex.com/avatar/64a5/3d53/544091_mini.png?m=1630044215","location":"","btc":null,"id":544091},"last_reply_by":"zhaozs1","last_touched":1631848822,"title":"2021 年的 Windows 上有没有类似 mac 的 Alfred 软件推荐？体验好，安装使用傻瓜的。","url":"https://www.v2ex.com/t/802471","created":1631844338,"content":"大佬们好，\r\n\r\n用过 wox 和 everything，有个还需要 python 支持包，好麻烦。\r\n\r\n求推荐更好，更傻瓜，更简单的。","content_rendered":"大佬们好，<br /><br />用过 wox 和 everything，有个还需要 python 支持包，好麻烦。<br /><br />求推荐更好，更傻瓜，更简单的。","last_modified":1631844338,"replies":16,"id":802471},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1630652774","name":"career","avatar_normal":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1630652774","title":"职场话题","url":"https://www.v2ex.com/go/career","topics":12107,"footer":"","header":"这里，我们聊聊那些工作中遇到的开心和不开心的事。","title_alternative":"Career","avatar_mini":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1630652774","stars":2160,"aliases":[],"root":false,"id":770,"parent_node_name":"work"},"member":{"username":"kisshere","website":"","github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/6157/5077/66454_mini.png?m=1404827302","bio":"","url":"https://www.v2ex.com/u/kisshere","tagline":"","twitter":null,"created":1403956444,"avatar_large":"https://cdn.v2ex.com/avatar/6157/5077/66454_mini.png?m=1404827302","avatar_mini":"https://cdn.v2ex.com/avatar/6157/5077/66454_mini.png?m=1404827302","location":"","btc":null,"id":66454},"last_reply_by":"hello158","last_touched":1631848865,"title":"总是没有勇气去提离职怎么办","url":"https://www.v2ex.com/t/802445","created":1631839284,"content":"晋升无望，也不想干目前味同嚼蜡的工作，工资还特别低，每天都在想去提离职。但总是患得患失，没有找到下家，疫情期间感觉工作也不会是那么好找，所以几次徘徊想去人力资源处但又打住了，但是干目前的工作真不想干了，这段时间因为从没想过要搞好这个工作，所以工作也马马虎虎，被领导多次批评，哎","content_rendered":"<p>晋升无望，也不想干目前味同嚼蜡的工作，工资还特别低，每天都在想去提离职。但总是患得患失，没有找到下家，疫情期间感觉工作也不会是那么好找，所以几次徘徊想去人力资源处但又打住了，但是干目前的工作真不想干了，这段时间因为从没想过要搞好这个工作，所以工作也马马虎虎，被领导多次批评，哎</p>\n","last_modified":1631840868,"replies":16,"id":802445},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1629391393","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1629391393","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":176600,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1629391393","stars":3318,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"username":"rrZ2C","website":"","github":"","psn":"","avatar_normal":"https://cdn.v2ex.com/gravatar/df0cd105b000b8d761fb807879b1fa7c?s=24&d=retro","bio":"","url":"https://www.v2ex.com/u/rrZ2C","tagline":"","twitter":"","created":1537841709,"avatar_large":"https://cdn.v2ex.com/gravatar/df0cd105b000b8d761fb807879b1fa7c?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/df0cd105b000b8d761fb807879b1fa7c?s=24&d=retro","location":"","btc":"","id":351876},"last_reply_by":"rj2","last_touched":1631847033,"title":"请问有没有什么快捷的方式给 U 盘做成多 Linux 系统的安装盘?","url":"https://www.v2ex.com/t/802456","created":1631841887,"content":"我在网上找了下基本都是说如何在 u 盘上安装多个 linux 作为便携,而我是想给 U 盘做成安装盘","content_rendered":"我在网上找了下基本都是说如何在 u 盘上安装多个 linux 作为便携,而我是想给 U 盘做成安装盘","last_modified":1631841887,"replies":13,"id":802456},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1629391393","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1629391393","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":176600,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1629391393","stars":3318,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"username":"adeweb","website":"","github":"","psn":"","avatar_normal":"https://cdn.v2ex.com/avatar/46f7/dac0/60852_mini.png?m=1621558389","bio":"","url":"https://www.v2ex.com/u/adeweb","tagline":"活着，并自得其乐。","twitter":"","created":1398068548,"avatar_large":"https://cdn.v2ex.com/avatar/46f7/dac0/60852_mini.png?m=1621558389","avatar_mini":"https://cdn.v2ex.com/avatar/46f7/dac0/60852_mini.png?m=1621558389","location":"银河系猎户旋臂太阳系","btc":"","id":60852},"last_reply_by":"adeweb","last_touched":1631845326,"title":"Obsidian Sync 值得付费吗？","url":"https://www.v2ex.com/t/802446","created":1631839355,"content":"Obsidian Sync 是 Obsidian 官方的同步服务，有没有用过的老铁，想知道稳定性和同步速度怎么样？\r\n我目前是用 iCloud (for Windows)来同步 iOS 、macOS 和 Windows 。\r\n用了一段时间，偶见一两次同步延迟和文件回档。\r\nObsidian Sync 下个月价格就要翻倍了，特此来问下大家。","content_rendered":"Obsidian Sync 是 Obsidian 官方的同步服务，有没有用过的老铁，想知道稳定性和同步速度怎么样？<br />我目前是用 iCloud (for Windows)来同步 iOS 、macOS 和 Windows 。<br />用了一段时间，偶见一两次同步延迟和文件回档。<br />Obsidian Sync 下个月价格就要翻倍了，特此来问下大家。","last_modified":1631839355,"replies":11,"id":802446},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/03af/dbd6/63_large.png?m=1627823094","name":"java","avatar_normal":"https://cdn.v2ex.com/navatar/03af/dbd6/63_normal.png?m=1627823094","title":"Java","url":"https://www.v2ex.com/go/java","topics":4591,"footer":"","header":"The most popular programming language.","title_alternative":"Java","avatar_mini":"https://cdn.v2ex.com/navatar/03af/dbd6/63_mini.png?m=1627823094","stars":4636,"aliases":[],"root":false,"id":63,"parent_node_name":"programming"},"member":{"username":"rapperx2","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/536f/97f5/238889_mini.png?m=1586173934","bio":null,"url":"https://www.v2ex.com/u/rapperx2","tagline":null,"twitter":null,"created":1499251763,"avatar_large":"https://cdn.v2ex.com/avatar/536f/97f5/238889_mini.png?m=1586173934","avatar_mini":"https://cdn.v2ex.com/avatar/536f/97f5/238889_mini.png?m=1586173934","location":null,"btc":null,"id":238889},"last_reply_by":"nicholasxuu","last_touched":1631845599,"title":"请教大佬们，微服务中多系统统一权限怎么设计","url":"https://www.v2ex.com/t/802442","created":1631838177,"content":"之前全部是单体应用，现在想改成微服务架构了。\r\n\r\n比如现在有 ERP，MES，OMS 这几个系统需要整合，但是每个系统权限控制都不一样，有的可能需要需要分企业账号和个人账号，权限分配给企业管理，每个企业有自己的权限控制。有的系统就只需要一个系统管理员做所有控制。\r\n\r\n之前都是自己的系统负责自己的权限控制，现在想做统一权限没经验，所以想请教下大佬们都是怎么做的。","content_rendered":"之前全部是单体应用，现在想改成微服务架构了。<br /><br />比如现在有 ERP，MES，OMS 这几个系统需要整合，但是每个系统权限控制都不一样，有的可能需要需要分企业账号和个人账号，权限分配给企业管理，每个企业有自己的权限控制。有的系统就只需要一个系统管理员做所有控制。<br /><br />之前都是自己的系统负责自己的权限控制，现在想做统一权限没经验，所以想请教下大佬们都是怎么做的。","last_modified":1631838177,"replies":9,"id":802442},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_large.png?m=1630652774","name":"career","avatar_normal":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_normal.png?m=1630652774","title":"职场话题","url":"https://www.v2ex.com/go/career","topics":12107,"footer":"","header":"这里，我们聊聊那些工作中遇到的开心和不开心的事。","title_alternative":"Career","avatar_mini":"https://cdn.v2ex.com/navatar/4ea0/6fbc/770_mini.png?m=1630652774","stars":2160,"aliases":[],"root":false,"id":770,"parent_node_name":"work"},"member":{"username":"labulaka521","website":"","github":"labulaka521","psn":"","avatar_normal":"https://cdn.v2ex.com/avatar/52a7/9168/250989_mini.png?m=1582958721","bio":"","url":"https://www.v2ex.com/u/labulaka521","tagline":"","twitter":"","created":1503787969,"avatar_large":"https://cdn.v2ex.com/avatar/52a7/9168/250989_mini.png?m=1582958721","avatar_mini":"https://cdn.v2ex.com/avatar/52a7/9168/250989_mini.png?m=1582958721","location":"","btc":"","id":250989},"last_reply_by":"fetich","last_touched":1631848968,"title":"转载: 半夜娃尿床突然发现被优化了，挺不爽的。","url":"https://www.v2ex.com/t/802488","created":1631847424,"content":"https://bbs.nga.cn/read.php?tid=28543216","content_rendered":"<a target=\"_blank\" href=\"https://bbs.nga.cn/read.php?tid=28543216\" rel=\"nofollow noopener\">https://bbs.nga.cn/read.php?tid=28543216</a>","last_modified":1631847897,"replies":8,"id":802488},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1630512279","name":"programmer","avatar_normal":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1630512279","title":"程序员","url":"https://www.v2ex.com/go/programmer","topics":45722,"footer":"","header":"While code monkeys are not eating bananas, they're coding.","title_alternative":"Programmer","avatar_mini":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1630512279","stars":7520,"aliases":[],"root":false,"id":300,"parent_node_name":"computer"},"member":{"username":"flycloud","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/gravatar/c9aac211a51266f85bd2d077520dedad?s=24&d=retro","bio":null,"url":"https://www.v2ex.com/u/flycloud","tagline":null,"twitter":null,"created":1524536002,"avatar_large":"https://cdn.v2ex.com/gravatar/c9aac211a51266f85bd2d077520dedad?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/c9aac211a51266f85bd2d077520dedad?s=24&d=retro","location":null,"btc":null,"id":311127},"last_reply_by":"flycloud","last_touched":1631846375,"title":"分享一个 id 自增生成器，依赖于 redis，求大佬帮忙挑挑毛病","url":"https://www.v2ex.com/t/802473","created":1631844483,"content":"看了雪花算法，服务需要配置标识位（数据中心 ID 、机器 ID ），多一项配置就多一份出错的风险，同时在不依赖其他基础服务的情况下也不太好解决时间回调的问题。然后自己实现了一个简化版的，依赖于 redis 。大佬们帮忙看看有啥问题没有，感谢。\r\n\r\n```\r\nfunc GlobalIncrId() (int64, error) {\r\n\tscript := redis.NewScript(`\r\n\t\tlocal key = KEYS[1]\r\n\t\tlocal stamp = ARGV[1]\r\n\t\t\r\n\t\tlocal newValue = redis.call(\"incr\", key)\r\n\t\tif newValue then\r\n\t\t\tif newValue > tonumber(stamp) then\r\n\t\t\t\treturn newValue\r\n\t\t\telse\r\n\t\t\t\tlocal flag = redis.call(\"set\", key, stamp)\r\n\t\t\t\tif flag then\r\n\t\t\t\t\treturn stamp\r\n\t\t\t\tend\r\n\t\t\tend\r\n\t\tend\r\n\t\r\n\t\treturn nil\r\n\t`)\r\n\tstamp := (time.Now().Unix() - 50 * 365 * 86400) << 22\r\n\tret, err := script.Run(RedisIns, []string{sredis.KEY_GLOBAL_INCR_ID}, stamp).Int64()\r\n\treturn ret, err\r\n}\r\n```\r\n\r\n自增 id 带上 stamp 信息, 是为了防止 redis 的 key 丢失, 或者值被清除。stamp 的计算回拨了 50 年, 因为 32bit 的时间戳到 2038 年就溢出了。只要机器的系统时间回调以及 key 失效这两件事不同时发生, 就能保持自增性。\r\n\r\n低 22 位用于 redis incr 自增，高位是时间信息，即 1s 内最多支持 4194304 个 id，超出了也没关系，只是会提前占用高位的时间。\r\n\r\n用 22 位来自增是因为某些业务可能会将 id 用在 zadd 中，zadd 的 score 范围是：-(2^53) 至 +(2^53), 即时间信息可以占用 31 位, 保证 score 不会溢出。","content_rendered":"<p>看了雪花算法，服务需要配置标识位（数据中心 ID 、机器 ID ），多一项配置就多一份出错的风险，同时在不依赖其他基础服务的情况下也不太好解决时间回调的问题。然后自己实现了一个简化版的，依赖于 redis 。大佬们帮忙看看有啥问题没有，感谢。</p>\n<pre><code>func GlobalIncrId() (int64, error) {\n\tscript := redis.NewScript(`\n\t\tlocal key = KEYS[1]\n\t\tlocal stamp = ARGV[1]\n\t\t\n\t\tlocal newValue = redis.call(\"incr\", key)\n\t\tif newValue then\n\t\t\tif newValue &gt; tonumber(stamp) then\n\t\t\t\treturn newValue\n\t\t\telse\n\t\t\t\tlocal flag = redis.call(\"set\", key, stamp)\n\t\t\t\tif flag then\n\t\t\t\t\treturn stamp\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\t\n\t\treturn nil\n\t`)\n\tstamp := (time.Now().Unix() - 50 * 365 * 86400) &lt;&lt; 22\n\tret, err := script.Run(RedisIns, []string{sredis.KEY_GLOBAL_INCR_ID}, stamp).Int64()\n\treturn ret, err\n}\n</code></pre>\n<p>自增 id 带上 stamp 信息, 是为了防止 redis 的 key 丢失, 或者值被清除。stamp 的计算回拨了 50 年, 因为 32bit 的时间戳到 2038 年就溢出了。只要机器的系统时间回调以及 key 失效这两件事不同时发生, 就能保持自增性。</p>\n<p>低 22 位用于 redis incr 自增，高位是时间信息，即 1s 内最多支持 4194304 个 id，超出了也没关系，只是会提前占用高位的时间。</p>\n<p>用 22 位来自增是因为某些业务可能会将 id 用在 zadd 中，zadd 的 score 范围是：-(2^53) 至 +(2^53), 即时间信息可以占用 31 位, 保证 score 不会溢出。</p>\n","last_modified":1631844483,"replies":8,"id":802473},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6512/bd43/11_large.png?m=1620106980","name":"linux","avatar_normal":"https://cdn.v2ex.com/navatar/6512/bd43/11_normal.png?m=1620106980","title":"Linux","url":"https://www.v2ex.com/go/linux","topics":6330,"footer":"","header":"Linux is a Unix-like computer operating system assembled under the model of free and open source software development and distribution.","title_alternative":"Linux","avatar_mini":"https://cdn.v2ex.com/navatar/6512/bd43/11_mini.png?m=1620106980","stars":5600,"aliases":[],"root":false,"id":11,"parent_node_name":"os"},"member":{"username":"wszgrcy","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/gravatar/d19e54e0aac1beeab935337a434652ca?s=24&d=retro","bio":null,"url":"https://www.v2ex.com/u/wszgrcy","tagline":null,"twitter":null,"created":1545829594,"avatar_large":"https://cdn.v2ex.com/gravatar/d19e54e0aac1beeab935337a434652ca?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/d19e54e0aac1beeab935337a434652ca?s=24&d=retro","location":null,"btc":null,"id":373159},"last_reply_by":"AoEiuV020","last_touched":1631848559,"title":"Linux 下挂载硬盘后一段时间不用,会自动休眠并且卸载是怎么回事?","url":"https://www.v2ex.com/t/802479","created":1631845560,"content":"- 比如有一个硬盘,我`mount`上了\r\n- 但是我并没有使用,过了一段时间后,发现挂载点里面没数据,一看`df -h`发现没了\r\n- 于是我又查`blkid`发现硬盘还是在的,于是再次执行`mount`又上来了...\r\n- 所以猜测,是不是大容量硬盘(usb)不用一段时间后会休眠?之前这块硬盘挂到 winodws 上也有类似情况,时间长不用,盘符是在的,但是双击进去发现很卡,同时硬盘转速会提升,然后大约 5.6 秒后才能进去,但是 windows 处理的相对好一些,至少盘符还是在的,linux 直接没了,只告诉你硬件还在....","content_rendered":"<ul>\n<li>比如有一个硬盘,我<code>mount</code>上了</li>\n<li>但是我并没有使用,过了一段时间后,发现挂载点里面没数据,一看<code>df -h</code>发现没了</li>\n<li>于是我又查<code>blkid</code>发现硬盘还是在的,于是再次执行<code>mount</code>又上来了...</li>\n<li>所以猜测,是不是大容量硬盘(usb)不用一段时间后会休眠?之前这块硬盘挂到 winodws 上也有类似情况,时间长不用,盘符是在的,但是双击进去发现很卡,同时硬盘转速会提升,然后大约 5.6 秒后才能进去,但是 windows 处理的相对好一些,至少盘符还是在的,linux 直接没了,只告诉你硬件还在....</li>\n</ul>\n","last_modified":1631845560,"replies":7,"id":802479},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/45c4/8cce/9_large.png?m=1611468519","name":"ipad","avatar_normal":"https://cdn.v2ex.com/navatar/45c4/8cce/9_normal.png?m=1611468519","title":"iPad","url":"https://www.v2ex.com/go/ipad","topics":1550,"footer":"","header":"<a href=\"/go/apple\">Apple</a> 公司设计的全新理念的基于 <a href=\"/go/ios\">iOS</a> 的平板电脑。","title_alternative":"iPad","avatar_mini":"https://cdn.v2ex.com/navatar/45c4/8cce/9_mini.png?m=1611468519","stars":1127,"aliases":[],"root":false,"id":9,"parent_node_name":"apple"},"member":{"username":"iovekkk","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/1490/878c/388030_mini.png?m=1574170695","bio":null,"url":"https://www.v2ex.com/u/iovekkk","tagline":null,"twitter":null,"created":1551332968,"avatar_large":"https://cdn.v2ex.com/avatar/1490/878c/388030_mini.png?m=1574170695","avatar_mini":"https://cdn.v2ex.com/avatar/1490/878c/388030_mini.png?m=1574170695","location":null,"btc":null,"id":388030},"last_reply_by":"VANHOR","last_touched":1631847424,"title":"iPad mini6 锁定最强游戏机，那么问题来了","url":"https://www.v2ex.com/t/802475","created":1631845250,"content":"RT，玩大型游戏的时候，如何解决散热问题\r\n\r\n甚至，迫于人菜瘾大的缘故，可能还得边充电边玩游戏\r\n\r\n总所周知，只要边充电边玩的时候，抑制住机器发热，对电池的伤害就能降到最低\r\n\r\n那么，对于 iPad mini6 散热，大家有什么好的解决方案呢？","content_rendered":"<p>RT，玩大型游戏的时候，如何解决散热问题</p>\n<p>甚至，迫于人菜瘾大的缘故，可能还得边充电边玩游戏</p>\n<p>总所周知，只要边充电边玩的时候，抑制住机器发热，对电池的伤害就能降到最低</p>\n<p>那么，对于 iPad mini6 散热，大家有什么好的解决方案呢？</p>\n","last_modified":1631845250,"replies":7,"id":802475},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1629391393","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1629391393","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":176600,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1629391393","stars":3318,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"username":"b0644170fc","website":null,"github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/1912/410b/352494_mini.png?m=1554008461","bio":null,"url":"https://www.v2ex.com/u/b0644170fc","tagline":null,"twitter":null,"created":1538020164,"avatar_large":"https://cdn.v2ex.com/avatar/1912/410b/352494_mini.png?m=1554008461","avatar_mini":"https://cdn.v2ex.com/avatar/1912/410b/352494_mini.png?m=1554008461","location":null,"btc":null,"id":352494},"last_reply_by":"Mikewu","last_touched":1631848470,"title":"前段时间不是说 app 要取消启动页广告吗","url":"https://www.v2ex.com/t/802481","created":1631846074,"content":"我记得就在那一天打卡的时候没有启动页广告，现在咋好像又都有了...不管了吗","content_rendered":"我记得就在那一天打卡的时候没有启动页广告，现在咋好像又都有了...不管了吗","last_modified":1631846074,"replies":6,"id":802481},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/9dfc/d5e5/311_large.png?m=1579118897","name":"mongodb","avatar_normal":"https://cdn.v2ex.com/navatar/9dfc/d5e5/311_normal.png?m=1579118897","title":"MongoDB","url":"https://www.v2ex.com/go/mongodb","topics":353,"footer":"MongoDB can change the way you work with data.","header":"MongoDB is a free and open-source cross-platform document-oriented database program.","title_alternative":"MongoDB","avatar_mini":"https://cdn.v2ex.com/navatar/9dfc/d5e5/311_mini.png?m=1579118897","stars":714,"aliases":[],"root":false,"id":311,"parent_node_name":"db"},"member":{"username":"hvboekml","website":"https://hamibot.com/","github":"hamibot","psn":"","avatar_normal":"https://cdn.v2ex.com/avatar/d675/4414/237109_mini.png?m=1569381796","bio":"⭐ 免费微信公众号 RSS https://feeddd.org/\r\n\r\n⭐ 自动化脚本市场 https://hamibot.com/","url":"https://www.v2ex.com/u/hvboekml","tagline":"","twitter":"","created":1498377167,"avatar_large":"https://cdn.v2ex.com/avatar/d675/4414/237109_mini.png?m=1569381796","avatar_mini":"https://cdn.v2ex.com/avatar/d675/4414/237109_mini.png?m=1569381796","location":"","btc":"","id":237109},"last_reply_by":"hvboekml","last_touched":1631847766,"title":"百思不得其解的 MongoDB 问题：服务正常，但连接不上","url":"https://www.v2ex.com/t/802474","created":1631845074,"content":"我有个网站用的是 MongoDB 数据库，搞不懂的地方在于网站正常，但是 mongo 连不上。\r\n\r\n最近没动过配置，不敢贸然重启服务，求教下各位","content_rendered":"<p>我有个网站用的是 MongoDB 数据库，搞不懂的地方在于网站正常，但是 mongo 连不上。</p>\n<p>最近没动过配置，不敢贸然重启服务，求教下各位</p>\n","last_modified":1631845117,"replies":6,"id":802474},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913","name":"apple","avatar_normal":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913","title":"Apple","url":"https://www.v2ex.com/go/apple","topics":15814,"footer":"","header":"设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。","title_alternative":"Apple","avatar_mini":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913","stars":1921,"aliases":[],"root":false,"id":184,"parent_node_name":"hardware"},"member":{"username":"Apple2023","website":"","github":null,"psn":null,"avatar_normal":"https://cdn.v2ex.com/avatar/54c4/8265/495791_mini.png?m=1616120202","bio":"","url":"https://www.v2ex.com/u/Apple2023","tagline":"","twitter":null,"created":1592789519,"avatar_large":"https://cdn.v2ex.com/avatar/54c4/8265/495791_mini.png?m=1616120202","avatar_mini":"https://cdn.v2ex.com/avatar/54c4/8265/495791_mini.png?m=1616120202","location":"","btc":null,"id":495791},"last_reply_by":"AoEiuV020","last_touched":1631775759,"title":"你们的手机都戴保护壳吗？","url":"https://www.v2ex.com/t/802469","created":1631843893,"content":"","content_rendered":"","last_modified":1631843893,"replies":6,"id":802469},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_large.png?m=1630643913","name":"apple","avatar_normal":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_normal.png?m=1630643913","title":"Apple","url":"https://www.v2ex.com/go/apple","topics":15814,"footer":"","header":"设计了 <a href=\"/go/watch\">Apple Watch</a>，<a href=\"/go/ipad\">iPad</a>，<a href=\"/go/iphone\">iPhone</a>，<a href=\"/go/imac\">iMac</a> 及 <a href=\"/go/mbp\">MacBook Pro</a> 等电子产品的美国公司。","title_alternative":"Apple","avatar_mini":"https://cdn.v2ex.com/navatar/6cdd/60ea/184_mini.png?m=1630643913","stars":1921,"aliases":[],"root":false,"id":184,"parent_node_name":"hardware"},"member":{"username":"dicbldicbl","website":"","github":"","psn":"","avatar_normal":"https://cdn.v2ex.com/gravatar/00e83adf5506158c4d0f8d8cdb5c5c55?s=24&d=retro","bio":"","url":"https://www.v2ex.com/u/dicbldicbl","tagline":"","twitter":"","created":1572053239,"avatar_large":"https://cdn.v2ex.com/gravatar/00e83adf5506158c4d0f8d8cdb5c5c55?s=24&d=retro","avatar_mini":"https://cdn.v2ex.com/gravatar/00e83adf5506158c4d0f8d8cdb5c5c55?s=24&d=retro","location":"","btc":"","id":449254},"last_reply_by":"huntagain2008","last_touched":1631846826,"title":"本来还想着今年会有新的 iPod touch 发布的。。。","url":"https://www.v2ex.com/t/802468","created":1631843784,"content":"rt，结果提都没没提","content_rendered":"<p>rt，结果提都没没提</p>\n","last_modified":1631843799,"replies":6,"id":802468}]