[{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":526376,"username":"Fixedsys","url":"https://www.v2ex.com/u/Fixedsys","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/52a9/5da3/526376_mini.png?m=1664134302","avatar_normal":"https://cdn.v2ex.com/avatar/52a9/5da3/526376_normal.png?m=1664134302","avatar_large":"https://cdn.v2ex.com/avatar/52a9/5da3/526376_large.png?m=1664134302","created":1609417208,"last_modified":1664134302},"last_reply_by":"edinina","last_touched":1685850084,"title":"武汉校园碾压事件，现在有没有什么车可以发动后就扫描车四周有没有人的？","url":"https://www.v2ex.com/t/945606","created":1685842946,"deleted":0,"content":"新能源的车应该有这种功能吧？","content_rendered":"新能源的车应该有这种功能吧？","last_modified":1685842946,"replies":23,"id":945606},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1677911181","name":"programmer","avatar_normal":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1677911181","title":"程序员","url":"https://www.v2ex.com/go/programmer","topics":56322,"footer":"","header":"While code monkeys are not eating bananas, they're coding.","title_alternative":"Programmer","avatar_mini":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1677911181","stars":8414,"aliases":[],"root":false,"id":300,"parent_node_name":"computer"},"member":{"id":612551,"username":"tempw","url":"https://www.v2ex.com/u/tempw","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/dbe3761e60e8a67e7c04e1aed8827ddd?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/dbe3761e60e8a67e7c04e1aed8827ddd?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/dbe3761e60e8a67e7c04e1aed8827ddd?s=73&d=retro","created":1675652563,"last_modified":1675652563},"last_reply_by":"Tezos","last_touched":1685849424,"title":"价位 4000 的戴尔 ultrasharp27 寸 4k 显示器和价位 1600 的红米 4k 显示器差别在哪","url":"https://www.v2ex.com/t/945602","created":1685841369,"deleted":0,"content":"非专业人士，想知道具体差别。只知道都是 27 寸 4K 的。最近想买显示器。","content_rendered":"<p>非专业人士，想知道具体差别。只知道都是 27 寸 4K 的。最近想买显示器。</p>\n","last_modified":1685841369,"replies":23,"id":945602},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/eaae/339c/653_large.png?m=1678403810","name":"vps","avatar_normal":"https://cdn.v2ex.com/navatar/eaae/339c/653_normal.png?m=1678403810","title":"VPS","url":"https://www.v2ex.com/go/vps","topics":6513,"footer":"","header":"关于 VPS 购买和使用的讨论。","title_alternative":"VPS","avatar_mini":"https://cdn.v2ex.com/navatar/eaae/339c/653_mini.png?m=1678403810","stars":3076,"aliases":[],"root":false,"id":653,"parent_node_name":"cloud"},"member":{"id":444151,"username":"vincent7245","url":"https://www.v2ex.com/u/vincent7245","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/avatar/abba/0eb6/444151_mini.png?m=1680510323","avatar_normal":"https://cdn.v2ex.com/avatar/abba/0eb6/444151_normal.png?m=1680510323","avatar_large":"https://cdn.v2ex.com/avatar/abba/0eb6/444151_large.png?m=1680510323","created":1569811150,"last_modified":1680510323},"last_reply_by":"makelove","last_touched":1685849336,"title":"不知不觉买了一堆便宜 VPS，买服务器居然会成瘾","url":"https://www.v2ex.com/t/945609","created":1685844805,"deleted":0,"content":"买服务器居然也会上瘾，看到有便宜的就想买，不知不觉手里已经囤了一堆了。\r\n\r\n|服务商|配置|费用|用途|\r\n|---|---|---|---|\r\n|腾讯轻量无忧| 1C2G | 190/年|备案的网站、笔记、Bitwarden 、Gitea|\r\n|腾讯云首单优惠| 2C4G| 158 马上到期了|闲置|\r\n|狗云香港|1C1G| 100/ 年|魔法、建站|\r\n|狗云香港|1C1G| 100/年|魔法|\r\n|野草云|2C8G| 266/年|开发测试环境|\r\n|racknerd|2C3G|$32/年|邮箱服务、魔法|\r\n|racknerd|1C 0.5G|$10/年|魔法|\r\n\r\n除了国内的腾讯云轻量，其他的服务器负载很低，几户算是闲置了，还能再搭建什么服务让其物尽其用呢。","content_rendered":"<p>买服务器居然也会上瘾，看到有便宜的就想买，不知不觉手里已经囤了一堆了。</p>\n<table>\n<thead>\n<tr>\n<th>服务商</th>\n<th>配置</th>\n<th>费用</th>\n<th>用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>腾讯轻量无忧</td>\n<td>1C2G</td>\n<td>190/年</td>\n<td>备案的网站、笔记、Bitwarden 、Gitea</td>\n</tr>\n<tr>\n<td>腾讯云首单优惠</td>\n<td>2C4G</td>\n<td>158 马上到期了</td>\n<td>闲置</td>\n</tr>\n<tr>\n<td>狗云香港</td>\n<td>1C1G</td>\n<td>100/ 年</td>\n<td>魔法、建站</td>\n</tr>\n<tr>\n<td>狗云香港</td>\n<td>1C1G</td>\n<td>100/年</td>\n<td>魔法</td>\n</tr>\n<tr>\n<td>野草云</td>\n<td>2C8G</td>\n<td>266/年</td>\n<td>开发测试环境</td>\n</tr>\n<tr>\n<td>racknerd</td>\n<td>2C3G</td>\n<td>$32/年</td>\n<td>邮箱服务、魔法</td>\n</tr>\n<tr>\n<td>racknerd</td>\n<td>1C 0.5G</td>\n<td>$10/年</td>\n<td>魔法</td>\n</tr>\n</tbody></table><p>除了国内的腾讯云轻量，其他的服务器负载很低，几户算是闲置了，还能再搭建什么服务让其物尽其用呢。</p>\n","last_modified":1685844893,"replies":20,"id":945609},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":542219,"username":"ruoyutx","url":"https://www.v2ex.com/u/ruoyutx","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/06cf315e82fa50ce1f2c5392e0f6cf63?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/06cf315e82fa50ce1f2c5392e0f6cf63?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/06cf315e82fa50ce1f2c5392e0f6cf63?s=73&d=retro","created":1618226522,"last_modified":1618226522},"last_reply_by":"Lexgni","last_touched":1685848793,"title":"ios+WeChat 组合每次点开都要转圈 1-2 分钟","url":"https://www.v2ex.com/t/945599","created":1685839913,"deleted":0,"content":"点开 app 就是连接中，获取中，算了下时间，足足两分钟。wechat 用户。严重影响使用。如若圈圈没有转完。你点扫码，是无网络情况下的。也就是无法扫码。这就蛋疼了。坐个车，师傅等了我两分钟扫码！\r\n\r\n另外你们用的微信还是 wechat ？有没有和我一样的情况。抛开网络文字，流量，wifi 都试过了\r\n\r\n转圈情况长年有，但是这两天敏感日子特别严重","content_rendered":"<p>点开 app 就是连接中，获取中，算了下时间，足足两分钟。wechat 用户。严重影响使用。如若圈圈没有转完。你点扫码，是无网络情况下的。也就是无法扫码。这就蛋疼了。坐个车，师傅等了我两分钟扫码！</p>\n<p>另外你们用的微信还是 wechat ？有没有和我一样的情况。抛开网络文字，流量，wifi 都试过了</p>\n<p>转圈情况长年有，但是这两天敏感日子特别严重</p>\n","last_modified":1685839913,"replies":16,"id":945599},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_large.png?m=1680100332","name":"bb","avatar_normal":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_normal.png?m=1680100332","title":"宽带症候群","url":"https://www.v2ex.com/go/bb","topics":12913,"footer":"","header":"网速很重要。比快更快。","title_alternative":"Broadband Symptom Complex","avatar_mini":"https://cdn.v2ex.com/navatar/a3c6/5c29/108_mini.png?m=1680100332","stars":6493,"aliases":[],"root":false,"id":108,"parent_node_name":"geek"},"member":{"id":194317,"username":"Archeb","url":"https://www.v2ex.com/u/Archeb","website":"https://mozz.ie","twitter":"","psn":"","github":"Archeb","btc":"","location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/93f5d0e297fe1c30eb4cf540e214523a?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/93f5d0e297fe1c30eb4cf540e214523a?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/93f5d0e297fe1c30eb4cf540e214523a?s=73&d=retro","created":1475332938,"last_modified":1685835633},"last_reply_by":"S179276SP","last_touched":1685842620,"title":"OpenTrace: 你熟悉的可视化 Traceroute 工具，现已开源","url":"https://www.v2ex.com/t/945596","created":1685838697,"deleted":0,"content":"![]( https://i.imgur.com/ejQFIdt.png) \r\n\r\n[OpenTrace]( https://github.com/Archeb/opentrace) 是使用 .NET 6 和 Eto 框架开发的 NextTrace 的跨平台 GUI 界面，带来您熟悉但更强大的用户体验。\r\n\r\nOpenTrace 的特点有：\r\n\r\n- 跨平台原生 GUI （ Windows WPF / Linux GTK / macOS ）\r\n\r\n- 您熟悉但功能更强大的界面\r\n\r\n- 用户友好的界面和易于理解的参数描述\r\n\r\n- MTR 功能\r\n\r\n- 多语言支持\r\n\r\n## 预览\r\n\r\n![Windows]( https://i.imgur.com/kbQTStm.png)\r\n![MTR on Linux]( https://i.imgur.com/MxSHIcU.png)\r\n![macOS]( https://i.imgur.com/brB08tl.png)\r\n![Preferences on macOS]( https://i.imgur.com/X0L6c6S.png)\r\n\r\n## 获取\r\n\r\n您可以访问 https://github.com/Archeb/opentrace/releases 下载最新打包好的可执行文件，也可以获取代码并自己编译。\r\n\r\n本软件仍然处于早期开发阶段，可能存在许多缺陷和错误。您宝贵的使用反馈，是我们改进 OpenTrace 的动力。","content_rendered":"<p><img alt=\"\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/ejQFIdt.png\"/> </p>\n<p><a href=\"https://github.com/Archeb/opentrace\" rel=\"nofollow\">OpenTrace</a> 是使用 .NET 6 和 Eto 框架开发的 NextTrace 的跨平台 GUI 界面，带来您熟悉但更强大的用户体验。</p>\n<p>OpenTrace 的特点有：</p>\n<ul>\n<li>\n<p>跨平台原生 GUI （ Windows WPF / Linux GTK / macOS ）</p>\n</li>\n<li>\n<p>您熟悉但功能更强大的界面</p>\n</li>\n<li>\n<p>用户友好的界面和易于理解的参数描述</p>\n</li>\n<li>\n<p>MTR 功能</p>\n</li>\n<li>\n<p>多语言支持</p>\n</li>\n</ul>\n<h2>预览</h2>\n<p><img alt=\"Windows\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/kbQTStm.png\"/>\n<img alt=\"MTR on Linux\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/MxSHIcU.png\"/>\n<img alt=\"macOS\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/brB08tl.png\"/>\n<img alt=\"Preferences on macOS\" class=\"embedded_image\" loading=\"lazy\" referrerpolicy=\"no-referrer\" rel=\"noreferrer\" src=\"https://i.imgur.com/X0L6c6S.png\"/></p>\n<h2>获取</h2>\n<p>您可以访问 <a href=\"https://github.com/Archeb/opentrace/releases\" rel=\"nofollow\">https://github.com/Archeb/opentrace/releases</a> 下载最新打包好的可执行文件，也可以获取代码并自己编译。</p>\n<p>本软件仍然处于早期开发阶段，可能存在许多缺陷和错误。您宝贵的使用反馈，是我们改进 OpenTrace 的动力。</p>\n","last_modified":1685839215,"replies":15,"id":945596},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":542140,"username":"chichux","url":"https://www.v2ex.com/u/chichux","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_mini.png?m=1671073646","avatar_normal":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_normal.png?m=1671073646","avatar_large":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_large.png?m=1671073646","avatar_xlarge":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_xlarge.png?m=1671073646","avatar_xxlarge":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_xlarge.png?m=1671073646","avatar_xxxlarge":"https://cdn.v2ex.com/avatar/8996/5fb7/542140_xlarge.png?m=1671073646","created":1618194491,"last_modified":1671073646},"last_reply_by":"speed933","last_touched":1685848917,"title":"茅台小白，想给老爸买一两瓶茅台，哪里靠谱，还是就直接京东？","url":"https://www.v2ex.com/t/945603","created":1685841905,"deleted":0,"content":"","content_rendered":"","last_modified":1685841905,"replies":14,"id":945603},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/f61d/6947/375_large.png?m=1658910399","name":"go","avatar_normal":"https://cdn.v2ex.com/navatar/f61d/6947/375_normal.png?m=1658910399","title":"Go 编程语言","url":"https://www.v2ex.com/go/go","topics":2666,"footer":"","header":"Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。","title_alternative":"The Go Programming Language","avatar_mini":"https://cdn.v2ex.com/navatar/f61d/6947/375_mini.png?m=1658910399","stars":3574,"aliases":[],"root":false,"id":375,"parent_node_name":"programming"},"member":{"id":487962,"username":"RememberCurry","url":"https://www.v2ex.com/u/RememberCurry","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/4d63af9fb7fa86940ca151eb3422ed62?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/4d63af9fb7fa86940ca151eb3422ed62?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/4d63af9fb7fa86940ca151eb3422ed62?s=73&d=retro","created":1588748942,"last_modified":1685845251},"last_reply_by":"RememberCurry","last_touched":1685849033,"title":"用 Go 基于 epoll 实现一个最小化 IO 库","url":"https://www.v2ex.com/t/945616","created":1685845360,"deleted":0,"content":"目前 Go 圈有很多款异步的网络框架:\r\n\r\n- https://github.com/tidwall/evio\r\n- https://github.com/lesismal/nbio\r\n- https://github.com/panjf2000/gnet\r\n- https://github.com/cloudwego/netpoll\r\n- .......\r\n\r\n排名不分先后。\r\n\r\n这里面最早的实现是 evio 。evio 也存在一些问题，之前也写过[evio]( https://www.syst.top/posts/go/evio/)文章介绍过。 其他比如 nbio 和 gnet 也写过一些源码分析。\r\n\r\n为什么会出现这些框架？之前也提到过，由于标准库 netpoll 的一些特性:\r\n\r\n- 一个 conn 一个 goroutine 导致利用率低\r\n- 用户无法感知 conn 状态\r\n- .....\r\n\r\n这些框架在应用层上做了很多优化，比如:Worker Pool,Buffer,Ring Buffer,NoCopy......。\r\n\r\n都分析了好几篇的代码了，那么咋么说也得自己动手搞一个来达成学习目的。\r\n\r\n没错，这就是[easyio]( https://github.com/wuqinqiang/easyio)的由来。\r\n\r\n它是一个最小化的 IO 框架，只实现最核心的部分，加起来不超过 500 行代码。\r\n\r\n也没有用户端上层应用的优化，且目前只实现了 linux 的 epoll ，以及只能运行 tcp 协议。\r\n\r\n\r\n\r\n简单的 demo ，\r\n\r\n服务端:\r\n\r\n```go\r\n\r\npackage main\r\n\r\nimport (\r\n\t\"context\"\r\n\t\"fmt\"\r\n\t\"os\"\r\n\t\"os/signal\"\r\n\t\"syscall\"\r\n\r\n\t\"github.com/wuqinqiang/easyio\"\r\n)\r\n\r\nvar _ easyio.EventHandler = (*Handler)(nil)\r\n\r\ntype Handler struct{}\r\n\r\ntype EasyioKey struct{}\r\n\r\ntype Message struct{ Msg string }\r\n\r\nvar CtxKey EasyioKey\r\n\r\nfunc (h Handler) OnOpen(c easyio.Conn) context.Context {\r\n\treturn context.WithValue(context.Background(), CtxKey, Message{Msg: \"helloword\"})\r\n}\r\n\r\nfunc (h Handler) OnRead(ctx context.Context, c easyio.Conn) {\r\n\t_, ok := ctx.Value(CtxKey).(Message)\r\n\tif !ok {\r\n\t\treturn\r\n\t}\r\n\tvar b = make([]byte, 100)\r\n\t_, err := c.Read(b)\r\n\tif err != nil {\r\n\t\tfmt.Println(\"err:\", err)\r\n\t}\r\n\tfmt.Println(\"[Handler] read data:\", string(b))\r\n\r\n\tif _, err = c.Write(b); err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n}\r\n\r\nfunc (h Handler) OnClose(_ context.Context, c easyio.Conn) {\r\n\tfmt.Println(\"[Handler] closed\", c.Fd())\r\n}\r\n\r\nfunc main() {\r\n\te := easyio.New(\"tcp\", \":8090\",easyio.WithNumPoller(4), easyio.WithEventHandler(Handler{}))\r\n\r\n\tif err := e.Start(); err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tdefer e.Stop()\r\n\r\n\tc := make(chan os.Signal, 1)\r\n\tsignal.Notify(c, syscall.SIGTERM, syscall.SIGQUIT, syscall.SIGINT)\r\n\t<-c\r\n}\r\n\r\n```\r\n\r\n上面的代码，初始化一个 easyio ，启动一个 tcp 服务，监听端口 8090 ，options 里面设置 epoll 的数量，以及设置事件处理器。\r\n\r\n当一个新连接到来时会回调 OnOpen 函数，此时你可以设置自定义的 ctx ，那么当对应连接读事件到来 OnRead 回调，你可以拿到之前设置的 ctx ，调用 conn.Read 读取数据，且通过 Write 向对端写数据。\r\n\r\n这里需要注意的是，一个连接如果数据没读完，当 OnRead 执行结束，下一轮会继续触发回调代码，因为底层 epoll 采用的是 LT 触发方式。\r\n\r\n\r\n\r\n简单的客户端\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"fmt\"\r\n\t\"net\"\r\n\t\"os\"\r\n\t\"os/signal\"\r\n\t\"syscall\"\r\n)\r\n\r\nfunc main() {\r\n\tconn, err := net.Dial(\"tcp\", \":8090\")\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\tn, err := conn.Write([]byte(\"hello world\"))\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tgo func() {\r\n\t\tb := make([]byte, 100)\r\n\t\tif n, err = conn.Read(b); err != nil {\r\n\t\t\tpanic(err)\r\n\t\t}\r\n\t\tfmt.Println(\"read data:\", n, string(b))\r\n\t}()\r\n\r\n\tdefer conn.Close()\r\n\r\n\tch := make(chan os.Signal, 1)\r\n\tsignal.Notify(ch, syscall.SIGHUP, syscall.SIGINT, syscall.SIGTERM, syscall.SIGQUIT)\r\n\r\n\t<-ch\r\n}\r\n```\r\n\r\n源码地址:https://github.com/wuqinqiang/easyio","content_rendered":"<p>目前 Go 圈有很多款异步的网络框架:</p>\n<ul>\n<li><a href=\"https://github.com/tidwall/evio\" rel=\"nofollow\">https://github.com/tidwall/evio</a></li>\n<li><a href=\"https://github.com/lesismal/nbio\" rel=\"nofollow\">https://github.com/lesismal/nbio</a></li>\n<li><a href=\"https://github.com/panjf2000/gnet\" rel=\"nofollow\">https://github.com/panjf2000/gnet</a></li>\n<li><a href=\"https://github.com/cloudwego/netpoll\" rel=\"nofollow\">https://github.com/cloudwego/netpoll</a></li>\n<li>.......</li>\n</ul>\n<p>排名不分先后。</p>\n<p>这里面最早的实现是 evio 。evio 也存在一些问题，之前也写过<a href=\"https://www.syst.top/posts/go/evio/\" rel=\"nofollow\">evio</a>文章介绍过。 其他比如 nbio 和 gnet 也写过一些源码分析。</p>\n<p>为什么会出现这些框架？之前也提到过，由于标准库 netpoll 的一些特性:</p>\n<ul>\n<li>一个 conn 一个 goroutine 导致利用率低</li>\n<li>用户无法感知 conn 状态</li>\n<li>.....</li>\n</ul>\n<p>这些框架在应用层上做了很多优化，比如:Worker Pool,Buffer,Ring Buffer,NoCopy......。</p>\n<p>都分析了好几篇的代码了，那么咋么说也得自己动手搞一个来达成学习目的。</p>\n<p>没错，这就是<a href=\"https://github.com/wuqinqiang/easyio\" rel=\"nofollow\">easyio</a>的由来。</p>\n<p>它是一个最小化的 IO 框架，只实现最核心的部分，加起来不超过 500 行代码。</p>\n<p>也没有用户端上层应用的优化，且目前只实现了 linux 的 epoll ，以及只能运行 tcp 协议。</p>\n<p>简单的 demo ，</p>\n<p>服务端:</p>\n<pre><code class=\"language-go\">\npackage main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\t\"os\"\n\t\"os/signal\"\n\t\"syscall\"\n\n\t\"github.com/wuqinqiang/easyio\"\n)\n\nvar _ easyio.EventHandler = (*Handler)(nil)\n\ntype Handler struct{}\n\ntype EasyioKey struct{}\n\ntype Message struct{ Msg string }\n\nvar CtxKey EasyioKey\n\nfunc (h Handler) OnOpen(c easyio.Conn) context.Context {\n\treturn context.WithValue(context.Background(), CtxKey, Message{Msg: \"helloword\"})\n}\n\nfunc (h Handler) OnRead(ctx context.Context, c easyio.Conn) {\n\t_, ok := ctx.Value(CtxKey).(Message)\n\tif !ok {\n\t\treturn\n\t}\n\tvar b = make([]byte, 100)\n\t_, err := c.Read(b)\n\tif err != nil {\n\t\tfmt.Println(\"err:\", err)\n\t}\n\tfmt.Println(\"[Handler] read data:\", string(b))\n\n\tif _, err = c.Write(b); err != nil {\n\t\tpanic(err)\n\t}\n}\n\nfunc (h Handler) OnClose(_ context.Context, c easyio.Conn) {\n\tfmt.Println(\"[Handler] closed\", c.Fd())\n}\n\nfunc main() {\n\te := easyio.New(\"tcp\", \":8090\",easyio.WithNumPoller(4), easyio.WithEventHandler(Handler{}))\n\n\tif err := e.Start(); err != nil {\n\t\tpanic(err)\n\t}\n\n\tdefer e.Stop()\n\n\tc := make(chan os.Signal, 1)\n\tsignal.Notify(c, syscall.SIGTERM, syscall.SIGQUIT, syscall.SIGINT)\n\t&lt;-c\n}\n\n</code></pre>\n<p>上面的代码，初始化一个 easyio ，启动一个 tcp 服务，监听端口 8090 ，options 里面设置 epoll 的数量，以及设置事件处理器。</p>\n<p>当一个新连接到来时会回调 OnOpen 函数，此时你可以设置自定义的 ctx ，那么当对应连接读事件到来 OnRead 回调，你可以拿到之前设置的 ctx ，调用 conn.Read 读取数据，且通过 Write 向对端写数据。</p>\n<p>这里需要注意的是，一个连接如果数据没读完，当 OnRead 执行结束，下一轮会继续触发回调代码，因为底层 epoll 采用的是 LT 触发方式。</p>\n<p>简单的客户端</p>\n<pre><code class=\"language-go\">package main\n\nimport (\n\t\"fmt\"\n\t\"net\"\n\t\"os\"\n\t\"os/signal\"\n\t\"syscall\"\n)\n\nfunc main() {\n\tconn, err := net.Dial(\"tcp\", \":8090\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tn, err := conn.Write([]byte(\"hello world\"))\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tgo func() {\n\t\tb := make([]byte, 100)\n\t\tif n, err = conn.Read(b); err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t\tfmt.Println(\"read data:\", n, string(b))\n\t}()\n\n\tdefer conn.Close()\n\n\tch := make(chan os.Signal, 1)\n\tsignal.Notify(ch, syscall.SIGHUP, syscall.SIGINT, syscall.SIGTERM, syscall.SIGQUIT)\n\n\t&lt;-ch\n}\n</code></pre>\n<p>源码地址:<a href=\"https://github.com/wuqinqiang/easyio\" rel=\"nofollow\">https://github.com/wuqinqiang/easyio</a></p>\n","last_modified":1685845360,"replies":10,"id":945616},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":151776,"username":"badboy200600","url":"https://www.v2ex.com/u/badboy200600","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/5ac75703162e277b442bea635ba53c57?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/5ac75703162e277b442bea635ba53c57?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/5ac75703162e277b442bea635ba53c57?s=73&d=retro","created":1450322962,"last_modified":1450322962},"last_reply_by":"badboy200600","last_touched":1685846680,"title":"ios17 会有些什么新功能？","url":"https://www.v2ex.com/t/945611","created":1685844906,"deleted":0,"content":"会开放第三方商店下载吗\r\n\r\n会有通话录音吗\r\n\r\n会有双开吗","content_rendered":"会开放第三方商店下载吗<br /><br />会有通话录音吗<br /><br />会有双开吗","last_modified":1685844906,"replies":9,"id":945611},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_large.png?m=1677911181","name":"programmer","avatar_normal":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_normal.png?m=1677911181","title":"程序员","url":"https://www.v2ex.com/go/programmer","topics":56322,"footer":"","header":"While code monkeys are not eating bananas, they're coding.","title_alternative":"Programmer","avatar_mini":"https://cdn.v2ex.com/navatar/94f6/d7e0/300_mini.png?m=1677911181","stars":8414,"aliases":[],"root":false,"id":300,"parent_node_name":"computer"},"member":{"id":321901,"username":"Cola98","url":"https://www.v2ex.com/u/Cola98","website":"","twitter":null,"psn":null,"github":null,"btc":null,"location":"","tagline":"","bio":"","avatar_mini":"https://cdn.v2ex.com/gravatar/5c9226d84810e05b12e85a177b9eaa6d?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/5c9226d84810e05b12e85a177b9eaa6d?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/5c9226d84810e05b12e85a177b9eaa6d?s=73&d=retro","created":1528698017,"last_modified":1666268073},"last_reply_by":"lamls","last_touched":1685848485,"title":"mbp2015 换电池失败经验","url":"https://www.v2ex.com/t/945597","created":1685838880,"deleted":0,"content":"之前电脑是二手 mbp2015 ，型号是 A1398 ，用了一段时间换了固态，后来电池鼓包了，就打算把电池也换了，于是买了品胜的电池。当时找了几个视频，也找客服要了安装视频，不过因为本人急性子的原因，拆的过程中把触摸板还有键盘搞坏了，初步判断是有一根线没有安装回去。\r\n\r\n电池没什么毛病，就是换了电池之后电脑 CPU 占用特别高，风扇特别响。。 总得来说还是不能急，苹果得笔记本拆东西还是要心细一点。","content_rendered":"<p>之前电脑是二手 mbp2015 ，型号是 A1398 ，用了一段时间换了固态，后来电池鼓包了，就打算把电池也换了，于是买了品胜的电池。当时找了几个视频，也找客服要了安装视频，不过因为本人急性子的原因，拆的过程中把触摸板还有键盘搞坏了，初步判断是有一根线没有安装回去。</p>\n<p>电池没什么毛病，就是换了电池之后电脑 CPU 占用特别高，风扇特别响。。 总得来说还是不能急，苹果得笔记本拆东西还是要心细一点。</p>\n","last_modified":1685838880,"replies":9,"id":945597},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":585950,"username":"jonty","url":"https://www.v2ex.com/u/jonty","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_mini.png?m=1679818273","avatar_normal":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_normal.png?m=1679818273","avatar_large":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_large.png?m=1679818273","avatar_xlarge":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_xlarge.png?m=1679818273","avatar_xxlarge":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_xlarge.png?m=1679818273","avatar_xxxlarge":"https://cdn.v2ex.com/avatar/b8ce/9f31/585950_xlarge.png?m=1679818273","created":1656146688,"last_modified":1679818273},"last_reply_by":"SenLief","last_touched":1685850085,"title":"想买一辆公路车","url":"https://www.v2ex.com/t/945630","created":1685849060,"deleted":0,"content":"1.用于通勤，上班大概 10 公里左右的路程\r\n2.周末休闲骑行健身\r\n3.希望对小白友好，不容易出现无法骑行问题，小毛病可以接受\r\n\r\n目前看下来有推荐斯特拉 95 ，希望价位最高不超过 4.5k 。本身对公路车各种组件都不熟悉，所以希望是能直接买到的整车，各位 V 友们有推荐的车型吗？","content_rendered":"1.用于通勤，上班大概 10 公里左右的路程<br />2.周末休闲骑行健身<br />3.希望对小白友好，不容易出现无法骑行问题，小毛病可以接受<br /><br />目前看下来有推荐斯特拉 95 ，希望价位最高不超过 4.5k 。本身对公路车各种组件都不熟悉，所以希望是能直接买到的整车，各位 V 友们有推荐的车型吗？","last_modified":1685849060,"replies":8,"id":945630},{"node":{"avatar_large":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_large.png?m=1650095340","name":"qna","avatar_normal":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_normal.png?m=1650095340","title":"问与答","url":"https://www.v2ex.com/go/qna","topics":204372,"footer":"","header":"一个更好的世界需要你持续地提出好问题。","title_alternative":"Questions and Answers","avatar_mini":"https://cdn.v2ex.com/navatar/c20a/d4d7/12_mini.png?m=1650095340","stars":3825,"aliases":[],"root":false,"id":12,"parent_node_name":"v2ex"},"member":{"id":624152,"username":"luobogooooo","url":"https://www.v2ex.com/u/luobogooooo","website":null,"twitter":null,"psn":null,"github":null,"btc":null,"location":null,"tagline":null,"bio":null,"avatar_mini":"https://cdn.v2ex.com/gravatar/bf05e2d2f2bee31c6d76e882537b36cb?s=24&d=retro","avatar_normal":"https://cdn.v2ex.com/gravatar/bf05e2d2f2bee31c6d76e882537b36cb?s=48&d=retro","avatar_large":"https://cdn.v2ex.com/gravatar/bf05e2d2f2bee31c6d76e882537b36cb?s=73&d=retro","created":1681464556,"last_modified":1681464556},"last_reply_by":"zhaokun","last_touched":1685847841,"title":"准备转岗软件销售，大佬们有什么建议吗","url":"https://www.v2ex.com/t/945612","created":1685844972,"deleted":0,"content":"做了 6 年前端被裁，社交能力差想改变一下自己，就想着转做软件销售，0 经验，大佬们有什么入门经验吗","content_rendered":"做了 6 年前端被裁，社交能力差想改变一下自己，就想着转做软件销售，0 经验，大佬们有什么入门经验吗","last_modified":1685844972,"replies":6,"id":945612}]